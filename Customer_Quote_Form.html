<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paskal - Customer Quote Request</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --paskal-green: #32AF46;
            --paskal-navy: #002C5B;
            --paskal-dark-green: #007350;
            --paskal-light-blue: #00AFE6;
            --error-red: #dc2626;
            --warning-yellow: #fbbf24;
            --success-green: #10b981;
            --gray-light: #f5f5f5;
            --gray-medium: #e0e0e0;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 95%;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: var(--paskal-navy);
            color: white;
            padding: 25px 40px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            min-width: 200px;
            min-height: 70px;
        }
        
        .logo img {
            height: 55px;
            width: auto;
        }

        .header-text h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .header-text p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        /* Main Card */
        .main-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        /* Help Box */
        .help-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid var(--paskal-light-blue);
        }

        .help-box h4 {
            color: var(--paskal-navy);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .help-box ul {
            list-style: none;
            padding: 0;
        }

        .help-box li {
            padding: 5px 0;
            font-size: 0.9rem;
            color: #1565c0;
        }

        .help-box li::before {
            content: "‚Üí ";
            color: var(--paskal-light-blue);
            font-weight: bold;
            margin-right: 5px;
        }

        /* Toolbar */
        .toolbar {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            padding: 15px;
            background: var(--gray-light);
            border-radius: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--paskal-green);
            color: white;
        }

        .btn-primary:hover {
            background: #2a9d3c;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(50, 175, 70, 0.3);
        }

        .btn-success {
            background: var(--success-green);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-secondary {
            background: var(--gray-medium);
            color: #333;
        }

        .btn-secondary:hover {
            background: #bdbdbd;
        }

        /* Table Container */
        .table-container {
            background: white;
            border: 2px solid var(--gray-medium);
            border-radius: 10px;
            overflow: auto;
            max-height: 600px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        /* Dynamic Table */
        .quote-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .quote-table thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .quote-table th {
            background: var(--paskal-navy);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.1);
            white-space: nowrap;
            font-size: 0.8rem;
        }

        .quote-table td {
            padding: 6px;
            border: 1px solid var(--gray-medium);
            background: white;
            vertical-align: top;
            min-height: 50px;
            max-height: 50px;
            height: 50px;
        }

        .quote-table tbody tr:hover {
            background: #f0f9ff;
        }

        .quote-table tbody tr.editing {
            background: #fff7ed;
        }

        /* Duplicate Preview - Blue highlight */
        .quote-table tbody tr.duplicate-preview {
            background: #bfdbfe !important;  /* Stronger blue */
            border: none !important;
            box-shadow: inset 0 0 0 2px #3b82f6;  /* Inner border */
            transition: all 0.3s ease;
        }
        
        .quote-table tbody tr.duplicate-preview td {
            background: transparent !important;  /* Ensure cells don't override */
        }
        
        .quote-table tbody tr.duplicate-preview .cell-calculated,
        .quote-table tbody tr.duplicate-preview input,
        .quote-table tbody tr.duplicate-preview select {
            background: transparent !important;  /* Override all backgrounds */
        }

        /* Duplicated rows - Yellow highlight */
        .quote-table tbody tr.duplicate-highlight {
            background: #fde68a !important;  /* Stronger yellow */
            border: none !important;
            box-shadow: inset 0 0 0 2px #f59e0b;  /* Inner border */
            animation: pulse-yellow 1s ease-in-out 3;
        }
        
        .quote-table tbody tr.duplicate-highlight td {
            background: transparent !important;  /* Ensure cells don't override */
        }
        
        .quote-table tbody tr.duplicate-highlight .cell-calculated,
        .quote-table tbody tr.duplicate-highlight input,
        .quote-table tbody tr.duplicate-highlight select {
            background: transparent !important;  /* Override all backgrounds */
        }

        @keyframes pulse-yellow {
            0%, 100% {
                transform: scale(1);
                box-shadow: inset 0 0 0 2px #f59e0b, 0 0 0 0 rgba(245, 158, 11, 0.4);
            }
            50% {
                transform: scale(1.01);
                box-shadow: inset 0 0 0 2px #f59e0b, 0 0 0 8px rgba(245, 158, 11, 0);
            }
        }

        /* Selection Mode Sticky Banner */
        .selection-banner {
            position: sticky;
            top: 0;
            z-index: 100;
            background: #e0f2fe;
            border: 2px solid #0284c7;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(2, 132, 199, 0.2);
            animation: slideDown 0.3s ease-out;
        }

        .selection-banner-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .selection-banner-icon {
            font-size: 1.5rem;
            color: #0284c7;
        }

        .selection-banner-text {
            color: #0c4a6e;
            font-size: 1rem;
            font-weight: 500;
        }

        .selection-banner-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #0284c7;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .selection-banner-close:hover {
            background: #bae6fd;
            color: #0c4a6e;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cell Inputs */
        .cell-input,
        .cell-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid var(--gray-medium);
            border-radius: 4px;
            font-size: 0.85rem;
            font-family: inherit;
            height: 34px;
            box-sizing: border-box;
        }
        
        /* Date input specific styling */
        input[type="date"].cell-input {
            cursor: pointer;
        }
        
        input[type="date"].cell-input::-webkit-calendar-picker-indicator {
            cursor: pointer;
            font-size: 1.1rem;
        }
        
        /* Date display input with calendar icon */
        .date-display-input {
            padding-right: 35px !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2332AF46' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 18px 18px;
        }
        
        /* Center select text for color dropdowns */
        select.color-select-field {
            text-align: center;
            text-align-last: center;
        }
        
        select.color-select-field option {
            text-align: center;
        }

        .cell-input:focus,
        .cell-select:focus {
            outline: none;
            border-color: var(--paskal-green);
            box-shadow: 0 0 0 2px rgba(50, 175, 70, 0.1);
        }

        .cell-input.error {
            border-color: var(--error-red);
            background: #fef2f2;
        }

        .cell-calculated {
            background: #f0fdf4;
            font-weight: 600;
            text-align: center;
            padding: 8px;
            color: var(--paskal-dark-green);
        }

        /* Row Number */
        .row-number {
            background: var(--gray-light);
            font-weight: 700;
            text-align: center;
            color: #666;
            width: 40px;
        }

        /* Row Actions */
        .row-actions {
            display: flex;
            gap: 4px;
            justify-content: center;
            align-items: center;
        }

        .row-action-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 6px;
            border-radius: 4px;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .row-action-btn:hover {
            background: var(--gray-medium);
            transform: scale(1.1);
        }

        /* Colors Button */
        .colors-btn {
            padding: 6px 12px;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .colors-btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        /* Summary Section */
        .summary-section {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(50, 175, 70, 0.1) 0%, rgba(50, 175, 70, 0.05) 100%);
            border-radius: 10px;
            border: 2px solid var(--paskal-green);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .summary-item label {
            display: block;
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .summary-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--paskal-navy);
        }

        .summary-item .unit {
            font-size: 0.9rem;
            color: #999;
            margin-left: 5px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-medium);
        }

        .modal-header h3 {
            color: var(--paskal-navy);
            font-size: 1.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .modal-close:hover {
            background: var(--gray-light);
            color: #333;
        }

        /* Alert */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            border-left: 5px solid;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left-color: var(--success-green);
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border-left-color: var(--error-red);
        }

        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border-left-color: var(--warning-yellow);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        /* Validation Badge */
        .validation-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }

        .validation-badge.valid {
            background: #d1fae5;
            color: #065f46;
        }

        .validation-badge.invalid {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Scrollbar Styling */
        .table-container::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    
        .input-valid {
            border: 2px solid #16a34a !important;
            background-color: #f0fdf4 !important;
        }
        
        .input-invalid {
            border: 2px solid #dc2626 !important;
            background-color: #fef2f2 !important;
        }
        
        .cell-calculated.input-valid {
            background-color: #dcfce7 !important;
            color: #16a34a !important;
        }
        
        .cell-calculated.input-invalid {
            background-color: #fee2e2 !important;
            color: #dc2626 !important;
        }
    
        /* ========================================
           TABS SYSTEM
           ======================================== */
        .tabs-container {
            margin-bottom: 0;
        }
        
        .tabs {
            display: flex;
            background: var(--paskal-navy);
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab {
            flex: 1;
            padding: 18px 30px;
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.6);
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
        }
        
        .tab:hover {
            background: rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.8);
        }
        
        .tab.active {
            background: white;
            color: var(--paskal-navy);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ========================================
           MY ORDERS TABLE
           ======================================== */
        .orders-container {
            background: white;
            padding: 40px;
            border-radius: 0 0 15px 15px;
        }
        
        .orders-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .orders-header h2 {
            color: var(--paskal-navy);
            font-size: 1.8rem;
        }
        
        .orders-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .orders-table thead {
            background: var(--paskal-navy);
            color: white;
        }
        
        .orders-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .orders-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .orders-table tbody tr:hover {
            background: #f5f9ff;
        }
        
        .orders-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-draft {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-approved {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-rejected {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.3rem;
            padding: 5px 8px;
            transition: transform 0.2s;
        }
        
        .action-btn:hover {
            transform: scale(1.2);
        }
        
        .action-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

</style>
    <!-- SheetJS for Excel generation -->
    <!-- ExcelJS - Full formatting support! -->
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
</head>
<body>
    <div class="container">
        <!-- Tabs Navigation -->
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" onclick="TabManager.switchTab('create')">
                    üìù Create New Quote
                </button>
                <button class="tab" onclick="TabManager.switchTab('orders')">
                    üìã My Orders
                </button>
            </div>
        </div>
        
        <!-- Logo Header - Fixed at top -->
        <div class="header">
            <div class="logo">
                <img src="https://i.imgur.com/0L7qKHI.png" alt="Paskal Logo" style="height: 55px; width: auto; display: block;">
            </div>
            <div class="header-text">
                <h1>Customer Quote Request Form</h1>
                <p>Fill out your metal hooks requirements</p>
            </div>
            <div style="margin-left: auto; display: flex; align-items: center; gap: 15px;">
                <span id="userName" style="font-size: 1rem; font-weight: 500; color: white;"></span>
                <button onclick="logout()" style="background: #dc2626; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500; font-size: 0.95rem; transition: background 0.2s;">
                    Logout
                </button>
            </div>
        </div>
        
        <!-- Tab Content: Create Quote -->
        <div id="createTab" class="tab-content active">
        <div class="main-card">
            <div id="alertBox" class="alert"></div>

            <div class="table-container" id="tableContainer">
                <div class="empty-state">
                    <h3>No items yet</h3>
                    <p>Click "+ Add Item" to start adding items to your quote</p>
                </div>
            </div>
            
            <div style="margin-top: 20px; margin-left: 10px; display: flex; gap: 15px;">
                <button class="btn btn-success" onclick="QuoteUI.addRow()" style="padding: 12px 35px; font-size: 1rem;">
                    ‚ûï Add Item
                </button>
                <button class="btn btn-secondary" onclick="QuoteUI.toggleSelectionMode()" id="duplicateBtn" style="padding: 12px 35px; font-size: 1rem;">
                    üìã Duplicate Item
                </button>
            </div>
            
            <div class="summary-box" style="margin-top: 30px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 2px solid #e5e7eb;">
                <h3 style="margin-bottom: 15px; color: #1f2937;">üìä Quote Summary</h3>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    <div>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px;">Total Items</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: #1f2937;" id="summaryItems">0</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px;">Total Units</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: #1f2937;" id="summaryUnits">0</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px;">Total Boxes</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: #1f2937;" id="summaryBoxes">0</div>
                    </div>
                </div>
            </div>
            
            <!-- Customer Special Requests -->
            <div style="margin-top: 30px; padding: 20px; background: #fff; border-radius: 8px; border: 2px solid var(--paskal-teal);">
                <label for="specialRequests" style="display: block; margin-bottom: 10px; font-weight: 600; color: var(--paskal-navy); font-size: 1.1rem;">
                    üí¨ Customer Special Requests <span style="color: #888; font-weight: normal; font-size: 0.9rem;">(Optional)</span>
                </label>
                <textarea 
                    id="specialRequests" 
                    rows="4" 
                    maxlength="500"
                    placeholder="Enter any special requests or notes for this order (max 500 characters)..."
                    style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 1rem; resize: vertical; min-height: 100px; max-height: 150px;"
                ></textarea>
                <div style="text-align: right; margin-top: 5px; font-size: 0.85rem; color: #666;">
                    <span id="charCount">0</span>/500 characters
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" onclick="QuoteUI.generateQuote()" id="generateQuoteBtn" style="padding: 15px 50px; font-size: 1.2rem;">
                    üìã Generate Quote
                </button>
                <button class="btn btn-secondary" onclick="QuoteUI.cancelEdit()" id="cancelEditBtn" style="padding: 15px 50px; font-size: 1.2rem; display: none; margin-left: 15px;">
                    ‚Ü©Ô∏è Cancel Edit
                </button>
            </div>
            
            <div style="margin-top: 30px; padding: 25px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid var(--paskal-navy);">
                <h3 style="margin-bottom: 20px; color: var(--paskal-navy);">üìå General Remarks</h3>
                <ul style="list-style: none; padding: 0; line-height: 1.8;">
                    <li style="margin-bottom: 12px;">
                        <strong>‚Ä¢ Color Sequence:</strong> When selecting "Color Sequence", you define the arrangement of colors in each box.
                    </li>
                    <li style="margin-bottom: 12px;">
                        <strong>‚Ä¢ No Partial Boxes:</strong> We cannot ship partial boxes. Your quantity will be automatically rounded up to full boxes.
                    </li>
                    <li>
                        <strong>‚Ä¢ Auto-Calculations:</strong> Boxes and Product Number (PN) are calculated automatically based on your selections.
                    </li>
                </ul>
            </div>

            <!-- Duplicate Confirmation Modal -->
            <div id="duplicateConfirmModal" class="modal">
                <div class="modal-content" style="max-width: 450px;">
                    <h2 style="margin-bottom: 20px; color: var(--paskal-navy);">üìã Duplicate Rows</h2>
                    
                    <p style="margin-bottom: 20px; color: #666; font-size: 1.1rem;">
                        Duplicate <strong id="confirmRowCount">0</strong> selected row(s)?
                    </p>
                    
                    <p style="margin-bottom: 20px; color: #888; font-size: 0.9rem;">
                        This will create <strong id="confirmNewCount">0</strong> new row(s) at the end of your table.
                    </p>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn btn-secondary" onclick="QuoteUI.closeConfirmModal()">
                            Cancel
                        </button>
                        <button class="btn btn-primary" onclick="QuoteUI.executeDuplicate()">
                            ‚úì Yes, Duplicate
                        </button>
                    </div>
                </div>
            </div>

            <!-- Instructions Modal for Selection Mode -->
            <div id="instructionsModal" class="modal">
                <div class="modal-content" style="max-width: 500px;">
                    <h2 style="margin-bottom: 25px; color: var(--paskal-navy); display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2rem;">‚ÑπÔ∏è</span>
                        How to Duplicate Multiple Rows
                    </h2>
                    
                    <div style="background: #f0f9ff; padding: 20px; border-radius: 8px; border-left: 4px solid #0284c7; margin-bottom: 20px;">
                        <p style="margin: 0 0 15px 0; color: #0c4a6e; font-size: 1rem;">
                            Follow these simple steps:
                        </p>
                        
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div style="display: flex; gap: 12px; align-items: start;">
                                <span style="background: #0284c7; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</span>
                                <div>
                                    <strong style="color: #0c4a6e;">Check boxes next to rows</strong>
                                    <p style="margin: 5px 0 0 0; color: #64748b; font-size: 0.9rem;">Select the rows you want to duplicate using the checkboxes</p>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 12px; align-items: start;">
                                <span style="background: #0284c7; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</span>
                                <div>
                                    <strong style="color: #0c4a6e;">Click "Duplicate X Rows" button</strong>
                                    <p style="margin: 5px 0 0 0; color: #64748b; font-size: 0.9rem;">The button appears after you select at least one row</p>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 12px; align-items: start;">
                                <span style="background: #0284c7; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</span>
                                <div>
                                    <strong style="color: #0c4a6e;">Confirm duplication</strong>
                                    <p style="margin: 5px 0 0 0; color: #64748b; font-size: 0.9rem;">Review and confirm to create new rows</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #fef3c7; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                        <p style="margin: 0; color: #92400e; font-size: 0.9rem;">
                            <strong>üí° Tip:</strong> Use the "Select All" checkbox in the table header to quickly select all rows!
                        </p>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="btn btn-primary" onclick="QuoteUI.closeInstructionsModal()" style="padding: 12px 40px; font-size: 1rem;">
                            Got it!
                        </button>
                    </div>
                </div>
            </div>


            <div class="summary-section" id="summarySection" style="display: none;">
                <h3 style="color: var(--paskal-navy); margin-bottom: 10px;">üìä Quote Summary</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <label>Total Items</label>
                        <div class="value" id="summaryTotalItems">0</div>
                    </div>
                    <div class="summary-item">
                        <label>Total Units</label>
                        <div class="value" id="summaryTotalUnits">0 <span class="unit">hooks</span></div>
                    </div>
                    <div class="summary-item">
                        <label>Total Cartons</label>
                        <div class="value" id="summaryTotalCartons">0 <span class="unit">boxes</span></div>
                    </div>
                    <div class="summary-item">
                        <label>Total Weight</label>
                        <div class="value" id="summaryTotalWeight">0.00 <span class="unit">kg</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Colors Modal -->
    <div class="modal" id="colorsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üé® Wire Colors</h3>
                <button class="modal-close" onclick="QuoteUI.closeColorsModal()">√ó</button>
            </div>
            <div id="colorsModalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <!-- Validation Modal -->
    <div class="modal" id="validationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Required Fields Missing</h3>
                <button class="modal-close" onclick="QuoteUI.closeValidationModal()">√ó</button>
            </div>
            <div id="validationModalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    
        </div><!-- End Create Quote Tab -->
        
        <!-- Tab Content: My Orders -->
        <div id="ordersTab" class="tab-content">
            <div class="orders-container">
                <div class="orders-header">
                    <h2>üìã My Orders</h2>
                    <button class="btn btn-secondary" onclick="OrdersManager.refreshOrders()">
                        üîÑ Refresh
                    </button>
                </div>
                
                <div id="ordersTableContainer">
                    <!-- Table will be populated by JavaScript -->
                </div>
            </div>
        </div><!-- End My Orders Tab -->
        
    </div><!-- End Container -->
    
    <!-- ========================================
         CRITICAL: ROUNDING MODAL - DO NOT DELETE!
         This modal is essential for the system.
         It appears when user enters quantity that
         doesn't divide evenly by units/box.
         Without it, users cannot round quantities!
         ======================================== -->
    <!-- Rounding Modal -->
    <div class="modal" id="roundingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Partial Box Detected</h3>
            </div>
            <div id="roundingModalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

<script>
// ============================================
// CONFIGURATION & DATA
// ============================================

const CONFIG = {
    STORAGE_KEY: 'paskal_quote_items',
    
    // Transportation limits
    TRANSPORTATION: {
        'Container 20HC': { pallets: 10, cartonsPerPallet: 64, maxWeight: 16500 },
        'Container 40HC': { pallets: 21, cartonsPerPallet: 72, maxWeight: 19500 },
        'Container 40HC Sanitized': { pallets: 18, cartonsPerPallet: 64, maxWeight: 19500 },
        'Truck Turkey': { pallets: 23, cartonsPerPallet: 72, maxWeight: 19500 },
        'Truck Mexico': { pallets: 26, cartonsPerPallet: 64, maxWeight: 19500 },
        'LCL': { pallets: 999, cartonsPerPallet: 72, maxWeight: 999999 }
    },
    
    // Countries list
    COUNTRIES: [
        'Netherlands', 'Belgium', 'Germany', 'France', 'Spain', 'Italy', 'Poland', 'United Kingdom',
        'USA', 'Canada', 'Mexico', 'Chile', 'Brazil',
        'Israel', 'Turkey',
        'Japan', 'South Korea', 'Australia', 'New Zealand',
        'Morocco', 'Tunisia',
        'Other'
    ],
    
    // Crops
    CROPS: ['Tomato', 'Cucumber', 'Pepper'],
    
    // Hook types
    HOOK_TYPES: ['Turbo', 'Tail', 'No Free Fall'],
    
    // Hook sizes
    HOOK_SIZES: ['180', '220'],
    
    // Twine types
    TWINE_TYPES: ['1000', '1200', '1300', '1500', 'Bio250', 'Bio390'],
    
    // Display names for twine types (especially for BIO)
    TWINE_DISPLAY_NAMES: {
        '1000': '1000',
        '1200': '1200',
        '1300': '1300',
        '1500': '1500',
        'Bio250': 'strPas-Bio250N',
        'Bio390': 'strPas-Bio390N'
    },
    
    // Wire length validation ranges per twine type
    WIRE_RANGES: {
        '1000': { min: 3, max: 25 },
        '1200': { min: 2.5, max: 38 },
        '1300': { min: 6, max: 38 },
        '1500': { min: 5, max: 38 },
        'Bio250': { min: 6, max: 38 },
        'Bio390': { min: 2.5, max: 37.5 }
    },
    
    FREE_FALL_RANGE: { min: 0, max: 10 },

    
    // Colors
    COLORS: ['White', 'Black', 'Yellow', 'Green', 'Orange', 'Blue', 'Red', 'Mixed']
};

// Carton weights database (from Excel "Boxes for Pallets")
// Format: { hookSize-twineType-wireLength-hookSystem: { unitsPerCarton, weightPerCarton } }
const CARTON_DB = {
    "518-1000-5-Turbo": {unitsPerCarton: 550, weightPerCarton: 15.941},
    "518-1000-6-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.203},
    "518-1000-7-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.673},
    "518-1000-8-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.225},
    "518-1000-9-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.665},
    "518-1000-10-Turbo": {unitsPerCarton: 400, weightPerCarton: 13.801},
    "518-1000-11-Turbo": {unitsPerCarton: 370, weightPerCarton: 13.193},
    "518-1000-12-Turbo": {unitsPerCarton: 350, weightPerCarton: 12.871},
    "518-1000-13-Turbo": {unitsPerCarton: 320, weightPerCarton: 12.153},
    "518-1000-14-Turbo": {unitsPerCarton: 320, weightPerCarton: 12.473},
    "518-1000-15-Turbo": {unitsPerCarton: 280, weightPerCarton: 11.289},
    "518-1000-16-Turbo": {unitsPerCarton: 280, weightPerCarton: 11.569},
    "518-1000-17-Turbo": {unitsPerCarton: 280, weightPerCarton: 11.849},
    "518-1000-18-Turbo": {unitsPerCarton: 260, weightPerCarton: 11.317},
    "518-1000-19-Turbo": {unitsPerCarton: 260, weightPerCarton: 11.577},
    "518-1000-20-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.411},
    "518-1000-21-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.661},
    "518-1000-22-Turbo": {unitsPerCarton: 230, weightPerCarton: 11.019},
    "518-1000-23-Turbo": {unitsPerCarton: 230, weightPerCarton: 11.249},
    "522-1000-5-Turbo": {unitsPerCarton: 500, weightPerCarton: 15.498},
    "522-1000-6-Turbo": {unitsPerCarton: 420, weightPerCarton: 13.558},
    "522-1000-7-Turbo": {unitsPerCarton: 400, weightPerCarton: 13.348},
    "522-1000-8-Turbo": {unitsPerCarton: 400, weightPerCarton: 13.748},
    "522-1000-9-Turbo": {unitsPerCarton: 380, weightPerCarton: 13.478},
    "522-1000-10-Turbo": {unitsPerCarton: 360, weightPerCarton: 13.168},
    "522-1000-11-Turbo": {unitsPerCarton: 340, weightPerCarton: 12.818},
    "522-1000-12-Turbo": {unitsPerCarton: 340, weightPerCarton: 13.158},
    "522-1000-13-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.373},
    "522-1000-14-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.683},
    "522-1000-15-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.203},
    "522-1000-16-Turbo": {unitsPerCarton: 270, weightPerCarton: 11.683},
    "522-1000-17-Turbo": {unitsPerCarton: 270, weightPerCarton: 11.953},
    "522-1000-18-Turbo": {unitsPerCarton: 260, weightPerCarton: 11.798},
    "522-1000-19-Turbo": {unitsPerCarton: 260, weightPerCarton: 12.058},
    "522-1000-20-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.873},
    "522-1000-21-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.668},
    "522-1000-22-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.908},
    "522-1000-23-Turbo": {unitsPerCarton: 220, weightPerCarton: 11.198},
    "518-1000-5-Tail": {unitsPerCarton: 500, weightPerCarton: 14.561},
    "518-1000-6-Tail": {unitsPerCarton: 500, weightPerCarton: 15.061},
    "518-1000-7-Tail": {unitsPerCarton: 450, weightPerCarton: 14.081},
    "518-1000-8-Tail": {unitsPerCarton: 450, weightPerCarton: 14.531},
    "518-1000-9-Tail": {unitsPerCarton: 400, weightPerCarton: 13.401},
    "518-1000-10-Tail": {unitsPerCarton: 400, weightPerCarton: 13.801},
    "518-1000-11-Tail": {unitsPerCarton: 350, weightPerCarton: 12.521},
    "518-1000-12-Tail": {unitsPerCarton: 350, weightPerCarton: 12.871},
    "518-1000-13-Tail": {unitsPerCarton: 300, weightPerCarton: 11.441},
    "518-1000-14-Tail": {unitsPerCarton: 300, weightPerCarton: 11.741},
    "518-1000-15-Tail": {unitsPerCarton: 300, weightPerCarton: 12.041},
    "518-1000-16-Tail": {unitsPerCarton: 270, weightPerCarton: 11.183},
    "518-1000-17-Tail": {unitsPerCarton: 270, weightPerCarton: 11.453},
    "518-1000-18-Tail": {unitsPerCarton: 270, weightPerCarton: 11.723},
    "518-1000-19-Tail": {unitsPerCarton: 250, weightPerCarton: 11.161},
    "518-1000-20-Tail": {unitsPerCarton: 250, weightPerCarton: 11.411},
    "518-1000-21-Tail": {unitsPerCarton: 250, weightPerCarton: 11.661},
    "518-1000-22-Tail": {unitsPerCarton: 220, weightPerCarton: 10.573},
    "518-1000-23-Tail": {unitsPerCarton: 220, weightPerCarton: 10.793},
    "522-1000-5-Tail": {unitsPerCarton: 500, weightPerCarton: 15.498},
    "522-1000-6-Tail": {unitsPerCarton: 450, weightPerCarton: 14.473},
    "522-1000-7-Tail": {unitsPerCarton: 450, weightPerCarton: 14.923},
    "522-1000-8-Tail": {unitsPerCarton: 400, weightPerCarton: 13.748},
    "522-1000-9-Tail": {unitsPerCarton: 400, weightPerCarton: 14.148},
    "522-1000-10-Tail": {unitsPerCarton: 360, weightPerCarton: 13.168},
    "522-1000-11-Tail": {unitsPerCarton: 360, weightPerCarton: 13.528},
    "522-1000-12-Tail": {unitsPerCarton: 330, weightPerCarton: 12.793},
    "522-1000-13-Tail": {unitsPerCarton: 300, weightPerCarton: 11.998},
    "522-1000-14-Tail": {unitsPerCarton: 300, weightPerCarton: 12.298},
    "522-1000-15-Tail": {unitsPerCarton: 270, weightPerCarton: 11.413},
    "522-1000-16-Tail": {unitsPerCarton: 270, weightPerCarton: 11.683},
    "522-1000-17-Tail": {unitsPerCarton: 270, weightPerCarton: 11.953},
    "522-1000-18-Tail": {unitsPerCarton: 250, weightPerCarton: 11.373},
    "522-1000-19-Tail": {unitsPerCarton: 250, weightPerCarton: 11.623},
    "522-1000-20-Tail": {unitsPerCarton: 250, weightPerCarton: 11.873},
    "522-1000-21-Tail": {unitsPerCarton: 240, weightPerCarton: 11.668},
    "522-1000-22-Tail": {unitsPerCarton: 240, weightPerCarton: 11.908},
    "522-1000-23-Tail": {unitsPerCarton: 240, weightPerCarton: 12.148},
    "518-1200-3-Turbo": {unitsPerCarton: 620, weightPerCarton: 16.317},
    "518-1200-4-Turbo": {unitsPerCarton: 570, weightPerCarton: 15.535},
    "518-1200-5-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.136},
    "518-1200-6-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.551},
    "518-1200-7-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.114},
    "518-1200-8-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.504},
    "518-1200-9-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.292},
    "518-1200-10-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.357},
    "518-1200-11-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.722},
    "518-1200-12-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.436},
    "518-1200-13-Turbo": {unitsPerCarton: 360, weightPerCarton: 12.781},
    "518-1200-14-Turbo": {unitsPerCarton: 360, weightPerCarton: 13.08},
    "518-1200-15-Turbo": {unitsPerCarton: 340, weightPerCarton: 12.678},
    "518-1200-16-Turbo": {unitsPerCarton: 310, weightPerCarton: 11.884},
    "518-1200-17-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.141},
    "518-1200-18-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.398},
    "518-1200-19-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.656},
    "518-1200-20-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.129},
    "518-1200-21-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.37},
    "518-1200-22-Turbo": {unitsPerCarton: 280, weightPerCarton: 12.202},
    "518-1200-23-Turbo": {unitsPerCarton: 260, weightPerCarton: 11.6},
    "518-1200-24-Turbo": {unitsPerCarton: 240, weightPerCarton: 10.966},
    "518-1200-25-Turbo": {unitsPerCarton: 210, weightPerCarton: 9.864},
    "518-1200-26-Turbo": {unitsPerCarton: 290, weightPerCarton: 13.573},
    "518-1200-27-Turbo": {unitsPerCarton: 290, weightPerCarton: 13.814},
    "518-1200-28-Turbo": {unitsPerCarton: 270, weightPerCarton: 13.138},
    "518-1200-29-Turbo": {unitsPerCarton: 270, weightPerCarton: 13.362},
    "518-1200-30-Turbo": {unitsPerCarton: 250, weightPerCarton: 12.636},
    "522-1200-3-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.243},
    "522-1200-4-Turbo": {unitsPerCarton: 480, weightPerCarton: 14.102},
    "522-1200-5-Turbo": {unitsPerCarton: 460, weightPerCarton: 13.927},
    "522-1200-6-Turbo": {unitsPerCarton: 440, weightPerCarton: 13.719},
    "522-1200-7-Turbo": {unitsPerCarton: 420, weightPerCarton: 13.478},
    "522-1200-8-Turbo": {unitsPerCarton: 400, weightPerCarton: 13.204},
    "522-1200-9-Turbo": {unitsPerCarton: 400, weightPerCarton: 13.536},
    "522-1200-10-Turbo": {unitsPerCarton: 390, weightPerCarton: 13.54},
    "522-1200-11-Turbo": {unitsPerCarton: 390, weightPerCarton: 13.864},
    "522-1200-12-Turbo": {unitsPerCarton: 420, weightPerCarton: 15.221},
    "522-1200-13-Turbo": {unitsPerCarton: 350, weightPerCarton: 13.1},
    "522-1200-14-Turbo": {unitsPerCarton: 340, weightPerCarton: 13.029},
    "522-1200-15-Turbo": {unitsPerCarton: 340, weightPerCarton: 13.311},
    "522-1200-16-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.46},
    "522-1200-17-Turbo": {unitsPerCarton: 290, weightPerCarton: 11.945},
    "522-1200-18-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.186},
    "522-1200-19-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.426},
    "522-1200-20-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.667},
    "522-1200-21-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.908},
    "522-1200-22-Turbo": {unitsPerCarton: 290, weightPerCarton: 13.148},
    "522-1200-23-Turbo": {unitsPerCarton: 260, weightPerCarton: 12.081},
    "522-1200-24-Turbo": {unitsPerCarton: 260, weightPerCarton: 12.297},
    "522-1200-25-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.608},
    "522-1200-26-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.807},
    "522-1200-27-Turbo": {unitsPerCarton: 240, weightPerCarton: 12.006},
    "522-1200-28-Turbo": {unitsPerCarton: 240, weightPerCarton: 12.206},
    "522-1200-29-Turbo": {unitsPerCarton: 220, weightPerCarton: 11.433},
    "522-1200-30-Turbo": {unitsPerCarton: 220, weightPerCarton: 11.616},
    "518-1200-3-Tail": {unitsPerCarton: 500, weightPerCarton: 13.306},
    "518-1200-4-Tail": {unitsPerCarton: 500, weightPerCarton: 13.721},
    "518-1200-5-Tail": {unitsPerCarton: 450, weightPerCarton: 12.798},
    "518-1200-6-Tail": {unitsPerCarton: 450, weightPerCarton: 13.172},
    "518-1200-7-Tail": {unitsPerCarton: 400, weightPerCarton: 12.125},
    "518-1200-8-Tail": {unitsPerCarton: 400, weightPerCarton: 12.457},
    "518-1200-9-Tail": {unitsPerCarton: 370, weightPerCarton: 11.887},
    "518-1200-10-Tail": {unitsPerCarton: 370, weightPerCarton: 12.194},
    "518-1200-11-Tail": {unitsPerCarton: 360, weightPerCarton: 12.184},
    "518-1200-12-Tail": {unitsPerCarton: 360, weightPerCarton: 12.483},
    "518-1200-13-Tail": {unitsPerCarton: 360, weightPerCarton: 12.781},
    "518-1200-14-Tail": {unitsPerCarton: 360, weightPerCarton: 13.08},
    "518-1200-15-Tail": {unitsPerCarton: 350, weightPerCarton: 13.028},
    "518-1200-16-Tail": {unitsPerCarton: 350, weightPerCarton: 13.319},
    "518-1200-17-Tail": {unitsPerCarton: 300, weightPerCarton: 11.774},
    "518-1200-18-Tail": {unitsPerCarton: 300, weightPerCarton: 12.023},
    "518-1200-19-Tail": {unitsPerCarton: 300, weightPerCarton: 12.272},
    "518-1200-20-Tail": {unitsPerCarton: 300, weightPerCarton: 12.521},
    "518-1200-21-Tail": {unitsPerCarton: 280, weightPerCarton: 11.969},
    "518-1200-22-Tail": {unitsPerCarton: 280, weightPerCarton: 12.202},
    "518-1200-23-Tail": {unitsPerCarton: 280, weightPerCarton: 12.434},
    "518-1200-24-Tail": {unitsPerCarton: 260, weightPerCarton: 11.816},
    "518-1200-25-Tail": {unitsPerCarton: 260, weightPerCarton: 12.032},
    "518-1200-26-Tail": {unitsPerCarton: 260, weightPerCarton: 12.248},
    "518-1200-27-Tail": {unitsPerCarton: 240, weightPerCarton: 11.563},
    "518-1200-28-Tail": {unitsPerCarton: 240, weightPerCarton: 11.763},
    "518-1200-29-Tail": {unitsPerCarton: 240, weightPerCarton: 11.962},
    "518-1200-30-Tail": {unitsPerCarton: 220, weightPerCarton: 11.211},
    "522-1200-3-Tail": {unitsPerCarton: 500, weightPerCarton: 14.243},
    "522-1200-4-Tail": {unitsPerCarton: 490, weightPerCarton: 14.38},
    "522-1200-5-Tail": {unitsPerCarton: 490, weightPerCarton: 14.787},
    "522-1200-6-Tail": {unitsPerCarton: 440, weightPerCarton: 13.719},
    "522-1200-7-Tail": {unitsPerCarton: 440, weightPerCarton: 14.084},
    "522-1200-8-Tail": {unitsPerCarton: 440, weightPerCarton: 14.45},
    "522-1200-9-Tail": {unitsPerCarton: 440, weightPerCarton: 14.815},
    "522-1200-10-Tail": {unitsPerCarton: 390, weightPerCarton: 13.54},
    "522-1200-11-Tail": {unitsPerCarton: 390, weightPerCarton: 13.864},
    "522-1200-12-Tail": {unitsPerCarton: 350, weightPerCarton: 12.809},
    "522-1200-13-Tail": {unitsPerCarton: 330, weightPerCarton: 12.394},
    "522-1200-14-Tail": {unitsPerCarton: 330, weightPerCarton: 12.668},
    "522-1200-15-Tail": {unitsPerCarton: 330, weightPerCarton: 12.942},
    "522-1200-16-Tail": {unitsPerCarton: 300, weightPerCarton: 12.082},
    "522-1200-17-Tail": {unitsPerCarton: 300, weightPerCarton: 12.331},
    "522-1200-18-Tail": {unitsPerCarton: 300, weightPerCarton: 12.58},
    "522-1200-18-Tail": {unitsPerCarton: 300, weightPerCarton: 12.655},
    "522-1200-19-Tail": {unitsPerCarton: 270, weightPerCarton: 11.621},
    "522-1200-20-Tail": {unitsPerCarton: 270, weightPerCarton: 11.845},
    "522-1200-21-Tail": {unitsPerCarton: 270, weightPerCarton: 12.069},
    "522-1200-22-Tail": {unitsPerCarton: 270, weightPerCarton: 12.293},
    "522-1200-23-Tail": {unitsPerCarton: 250, weightPerCarton: 11.646},
    "522-1200-24-Tail": {unitsPerCarton: 250, weightPerCarton: 11.853},
    "522-1200-25-Tail": {unitsPerCarton: 240, weightPerCarton: 11.608},
    "522-1200-26-Tail": {unitsPerCarton: 240, weightPerCarton: 11.807},
    "522-1200-27-Tail": {unitsPerCarton: 220, weightPerCarton: 11.068},
    "522-1200-28-Tail": {unitsPerCarton: 220, weightPerCarton: 11.251},
    "522-1200-29-Tail": {unitsPerCarton: 200, weightPerCarton: 10.462},
    "522-1200-30-Tail": {unitsPerCarton: 200, weightPerCarton: 10.628},
    "518-1300-12-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.134},
    "518-1300-13-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.457},
    "518-1300-14-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.781},
    "518-1300-15-Turbo": {unitsPerCarton: 380, weightPerCarton: 13.738},
    "518-1300-16-Turbo": {unitsPerCarton: 380, weightPerCarton: 14.031},
    "518-1300-17-Turbo": {unitsPerCarton: 350, weightPerCarton: 13.252},
    "518-1300-18-Turbo": {unitsPerCarton: 350, weightPerCarton: 13.522},
    "518-1500-6-Turbo": {unitsPerCarton: 540, weightPerCarton: 15.136},
    "518-1500-7-Turbo": {unitsPerCarton: 540, weightPerCarton: 15.498},
    "518-1500-8-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.741},
    "518-1500-9-Turbo": {unitsPerCarton: 500, weightPerCarton: 15.076},
    "518-1500-10-Turbo": {unitsPerCarton: 490, weightPerCarton: 15.118},
    "518-1500-11-Turbo": {unitsPerCarton: 490, weightPerCarton: 15.446},
    "518-1500-12-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.549},
    "518-1500-13-Turbo": {unitsPerCarton: 410, weightPerCarton: 13.598},
    "518-1500-14-Turbo": {unitsPerCarton: 390, weightPerCarton: 13.233},
    "518-1500-15-Turbo": {unitsPerCarton: 390, weightPerCarton: 13.495},
    "518-1500-16-Turbo": {unitsPerCarton: 350, weightPerCarton: 12.423},
    "518-1500-17-Turbo": {unitsPerCarton: 340, weightPerCarton: 12.318},
    "518-1500-18-Turbo": {unitsPerCarton: 340, weightPerCarton: 12.545},
    "518-1500-19-Turbo": {unitsPerCarton: 330, weightPerCarton: 12.42},
    "518-1500-20-Turbo": {unitsPerCarton: 330, weightPerCarton: 12.641},
    "518-1500-21-Turbo": {unitsPerCarton: 330, weightPerCarton: 12.862},
    "518-1500-22-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.336},
    "518-1500-23-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.544},
    "518-1500-24-Turbo": {unitsPerCarton: 310, weightPerCarton: 12.752},
    "518-1500-25-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.172},
    "518-1500-26-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.367},
    "518-1500-27-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.561},
    "518-1500-28-Turbo": {unitsPerCarton: 270, weightPerCarton: 11.928},
    "518-1500-29-Turbo": {unitsPerCarton: 270, weightPerCarton: 12.109},
    "518-1500-30-Turbo": {unitsPerCarton: 270, weightPerCarton: 12.29},
    "518-1500-31-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.604},
    "518-1500-32-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.771},
    "518-1500-33-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.938},
    "522-1500-6-Turbo": {unitsPerCarton: 600, weightPerCarton: 17.86},
    "522-1500-7-Turbo": {unitsPerCarton: 550, weightPerCarton: 16.802},
    "522-1500-8-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.185},
    "522-1500-9-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.486},
    "522-1500-10-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.476},
    "522-1500-11-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.771},
    "522-1500-12-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.415},
    "522-1500-13-Turbo": {unitsPerCarton: 400, weightPerCarton: 14.032},
    "522-1500-14-Turbo": {unitsPerCarton: 400, weightPerCarton: 14.3},
    "522-1500-15-Turbo": {unitsPerCarton: 390, weightPerCarton: 14.222},
    "522-1500-16-Turbo": {unitsPerCarton: 390, weightPerCarton: 14.484},
    "522-1500-17-Turbo": {unitsPerCarton: 390, weightPerCarton: 14.745},
    "522-1500-18-Turbo": {unitsPerCarton: 390, weightPerCarton: 15.006},
    "522-1500-19-Turbo": {unitsPerCarton: 360, weightPerCarton: 14.151},
    "522-1500-20-Turbo": {unitsPerCarton: 330, weightPerCarton: 13.255},
    "522-1500-21-Turbo": {unitsPerCarton: 330, weightPerCarton: 13.476},
    "522-1500-22-Turbo": {unitsPerCarton: 300, weightPerCarton: 12.52},
    "522-1500-23-Turbo": {unitsPerCarton: 300, weightPerCarton: 12.721},
    "522-1500-24-Turbo": {unitsPerCarton: 290, weightPerCarton: 12.516},
    "522-1500-25-Turbo": {unitsPerCarton: 240, weightPerCarton: 10.648},
    "522-1500-26-Turbo": {unitsPerCarton: 240, weightPerCarton: 10.809},
    "522-1500-27-Turbo": {unitsPerCarton: 240, weightPerCarton: 10.97},
    "522-1500-28-Turbo": {unitsPerCarton: 250, weightPerCarton: 11.563},
    "522-1500-29-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.291},
    "522-1500-30-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.452},
    "522-1500-31-Turbo": {unitsPerCarton: 240, weightPerCarton: 11.613},
    "522-1500-32-Turbo": {unitsPerCarton: 230, weightPerCarton: 11.314},
    "522-1500-33-Turbo": {unitsPerCarton: 230, weightPerCarton: 11.468},
    "518-1500-6-Tail": {unitsPerCarton: 550, weightPerCarton: 15.402},
    "518-1500-7-Tail": {unitsPerCarton: 550, weightPerCarton: 15.771},
    "518-1500-8-Tail": {unitsPerCarton: 500, weightPerCarton: 14.741},
    "518-1500-9-Tail": {unitsPerCarton: 500, weightPerCarton: 15.076},
    "518-1500-10-Tail": {unitsPerCarton: 480, weightPerCarton: 14.825},
    "518-1500-11-Tail": {unitsPerCarton: 480, weightPerCarton: 15.147},
    "518-1500-12-Tail": {unitsPerCarton: 400, weightPerCarton: 13.017},
    "518-1500-13-Tail": {unitsPerCarton: 380, weightPerCarton: 12.659},
    "518-1500-14-Tail": {unitsPerCarton: 380, weightPerCarton: 12.913},
    "518-1500-15-Tail": {unitsPerCarton: 350, weightPerCarton: 12.188},
    "518-1500-16-Tail": {unitsPerCarton: 350, weightPerCarton: 12.423},
    "518-1500-17-Tail": {unitsPerCarton: 310, weightPerCarton: 11.298},
    "518-1500-18-Tail": {unitsPerCarton: 310, weightPerCarton: 11.506},
    "518-1500-19-Tail": {unitsPerCarton: 300, weightPerCarton: 11.36},
    "522-1500-6-Tail": {unitsPerCarton: 550, weightPerCarton: 16.434},
    "522-1500-7-Tail": {unitsPerCarton: 550, weightPerCarton: 16.802},
    "522-1500-8-Tail": {unitsPerCarton: 500, weightPerCarton: 15.678},
    "522-1500-9-Tail": {unitsPerCarton: 440, weightPerCarton: 14.181},
    "522-1500-10-Tail": {unitsPerCarton: 400, weightPerCarton: 13.228},
    "522-1500-11-Tail": {unitsPerCarton: 350, weightPerCarton: 11.902},
    "522-1500-12-Tail": {unitsPerCarton: 340, weightPerCarton: 11.812},
    "522-1500-13-Tail": {unitsPerCarton: 360, weightPerCarton: 12.704},
    "522-1500-14-Tail": {unitsPerCarton: 360, weightPerCarton: 12.945},
    "522-1500-15-Tail": {unitsPerCarton: 390, weightPerCarton: 14.222},
    "522-1500-16-Tail": {unitsPerCarton: 360, weightPerCarton: 13.427},
    "522-1500-17-Tail": {unitsPerCarton: 360, weightPerCarton: 13.668},
    "522-1500-18-Tail": {unitsPerCarton: 300, weightPerCarton: 11.716},
    "522-1500-19-Tail": {unitsPerCarton: 300, weightPerCarton: 11.917},
    "522-1500-20-Tail": {unitsPerCarton: 300, weightPerCarton: 12.118},
    "522-1500-21-Tail": {unitsPerCarton: 300, weightPerCarton: 12.319},
    "522-1500-22-Tail": {unitsPerCarton: 300, weightPerCarton: 12.52},
    "522-1500-23-Tail": {unitsPerCarton: 300, weightPerCarton: 12.721},
    "522-1500-24-Tail": {unitsPerCarton: 250, weightPerCarton: 10.893},
    "522-1500-25-Tail": {unitsPerCarton: 250, weightPerCarton: 11.06},
    "522-1500-26-Tail": {unitsPerCarton: 250, weightPerCarton: 11.228},
    "522-1500-27-Tail": {unitsPerCarton: 250, weightPerCarton: 11.396},
    "522-1500-28-Tail": {unitsPerCarton: 250, weightPerCarton: 11.563},
    "522-1500-29-Tail": {unitsPerCarton: 240, weightPerCarton: 11.291},
    "522-1500-30-Tail": {unitsPerCarton: 220, weightPerCarton: 10.56},
    "522-1500-31-Tail": {unitsPerCarton: 220, weightPerCarton: 10.707},
    "522-1500-32-Tail": {unitsPerCarton: 220, weightPerCarton: 10.855},
    "522-1500-33-Tail": {unitsPerCarton: 220, weightPerCarton: 11.002},
    "518-strPas-Bio250N-10-Turbo": {unitsPerCarton: 700, weightPerCarton: 20.501},
    "518-strPas-Bio250N-11-Turbo": {unitsPerCarton: 700, weightPerCarton: 20.893},
    "518-strPas-Bio250N-12-Turbo": {unitsPerCarton: 650, weightPerCarton: 19.819},
    "518-strPas-Bio250N-13-Turbo": {unitsPerCarton: 650, weightPerCarton: 20.183},
    "518-strPas-Bio250N-14-Turbo": {unitsPerCarton: 620, weightPerCarton: 19.634},
    "518-strPas-Bio250N-15-Turbo": {unitsPerCarton: 620, weightPerCarton: 19.981},
    "518-strPas-Bio250N-16-Turbo": {unitsPerCarton: 620, weightPerCarton: 20.328},
    "518-strPas-Bio250N-17-Turbo": {unitsPerCarton: 600, weightPerCarton: 20.033},
    "518-strPas-Bio250N-18-Turbo": {unitsPerCarton: 530, weightPerCarton: 18.081},
    "518-strPas-Bio250N-19-Turbo": {unitsPerCarton: 500, weightPerCarton: 17.381},
    "518-strPas-Bio250N-20-Turbo": {unitsPerCarton: 500, weightPerCarton: 17.661},
    "518-strPas-Bio250N-21-Turbo": {unitsPerCarton: 480, weightPerCarton: 17.254},
    "518-strPas-Bio250N-22-Turbo": {unitsPerCarton: 480, weightPerCarton: 17.523},
    "518-strPas-Bio250N-23-Turbo": {unitsPerCarton: 450, weightPerCarton: 16.727},
    "518-strPas-Bio250N-24-Turbo": {unitsPerCarton: 450, weightPerCarton: 16.979},
    "518-strPas-Bio250N-25-Turbo": {unitsPerCarton: 450, weightPerCarton: 17.231},
    "518-strPas-Bio250N-26-Turbo": {unitsPerCarton: 430, weightPerCarton: 16.74},
    "518-strPas-Bio250N-27-Turbo": {unitsPerCarton: 430, weightPerCarton: 16.981},
    "518-strPas-Bio250N-28-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.221},
    "518-strPas-Bio250N-29-Turbo": {unitsPerCarton: 400, weightPerCarton: 16.297},
    "518-strPas-Bio250N-30-Turbo": {unitsPerCarton: 400, weightPerCarton: 16.521},
    "522-strPas-Bio250N-10-Turbo": {unitsPerCarton: 700, weightPerCarton: 21.818},
    "522-strPas-Bio250N-11-Turbo": {unitsPerCarton: 700, weightPerCarton: 22.21},
    "522-strPas-Bio250N-12-Turbo": {unitsPerCarton: 650, weightPerCarton: 21.041},
    "522-strPas-Bio250N-13-Turbo": {unitsPerCarton: 600, weightPerCarton: 19.816},
    "522-strPas-Bio250N-14-Turbo": {unitsPerCarton: 600, weightPerCarton: 20.152},
    "522-strPas-Bio250N-15-Turbo": {unitsPerCarton: 600, weightPerCarton: 20.488},
    "522-strPas-Bio250N-16-Turbo": {unitsPerCarton: 550, weightPerCarton: 19.151},
    "522-strPas-Bio250N-17-Turbo": {unitsPerCarton: 550, weightPerCarton: 19.459},
    "522-strPas-Bio250N-18-Turbo": {unitsPerCarton: 500, weightPerCarton: 18.038},
    "522-strPas-Bio250N-19-Turbo": {unitsPerCarton: 500, weightPerCarton: 18.318},
    "522-strPas-Bio250N-20-Turbo": {unitsPerCarton: 500, weightPerCarton: 18.598},
    "522-strPas-Bio250N-21-Turbo": {unitsPerCarton: 450, weightPerCarton: 17.065},
    "522-strPas-Bio250N-22-Turbo": {unitsPerCarton: 450, weightPerCarton: 17.317},
    "522-strPas-Bio250N-23-Turbo": {unitsPerCarton: 450, weightPerCarton: 17.569},
    "522-strPas-Bio250N-24-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.062},
    "522-strPas-Bio250N-25-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.303},
    "522-strPas-Bio250N-26-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.544},
    "522-strPas-Bio250N-27-Turbo": {unitsPerCarton: 400, weightPerCarton: 16.596},
    "522-strPas-Bio250N-28-Turbo": {unitsPerCarton: 400, weightPerCarton: 16.82},
    "522-strPas-Bio250N-29-Turbo": {unitsPerCarton: 350, weightPerCarton: 15.007},
    "522-strPas-Bio250N-30-Turbo": {unitsPerCarton: 350, weightPerCarton: 15.203},
    "522-strPas-Bio250N-10-Tail": {unitsPerCarton: 600, weightPerCarton: 18.808},
    "522-strPas-Bio250N-11-Tail": {unitsPerCarton: 600, weightPerCarton: 19.144},
    "522-strPas-Bio250N-12-Tail": {unitsPerCarton: 600, weightPerCarton: 19.48},
    "522-strPas-Bio250N-13-Tail": {unitsPerCarton: 550, weightPerCarton: 18.227},
    "522-strPas-Bio250N-14-Tail": {unitsPerCarton: 550, weightPerCarton: 18.535},
    "522-strPas-Bio250N-15-Tail": {unitsPerCarton: 550, weightPerCarton: 18.843},
    "522-strPas-Bio250N-16-Tail": {unitsPerCarton: 550, weightPerCarton: 19.151},
    "522-strPas-Bio250N-17-Tail": {unitsPerCarton: 500, weightPerCarton: 17.758},
    "522-strPas-Bio250N-18-Tail": {unitsPerCarton: 500, weightPerCarton: 18.038},
    "522-strPas-Bio250N-19-Tail": {unitsPerCarton: 500, weightPerCarton: 18.318},
    "522-strPas-Bio250N-20-Tail": {unitsPerCarton: 500, weightPerCarton: 18.598},
    "522-strPas-Bio250N-21-Tail": {unitsPerCarton: 450, weightPerCarton: 17.065},
    "522-strPas-Bio250N-22-Tail": {unitsPerCarton: 450, weightPerCarton: 17.317},
    "522-strPas-Bio250N-23-Tail": {unitsPerCarton: 450, weightPerCarton: 17.569},
    "522-strPas-Bio250N-24-Tail": {unitsPerCarton: 450, weightPerCarton: 17.821},
    "522-strPas-Bio250N-25-Tail": {unitsPerCarton: 450, weightPerCarton: 18.073},
    "522-strPas-Bio250N-26-Tail": {unitsPerCarton: 400, weightPerCarton: 16.372},
    "522-strPas-Bio250N-27-Tail": {unitsPerCarton: 400, weightPerCarton: 16.596},
    "522-strPas-Bio250N-28-Tail": {unitsPerCarton: 400, weightPerCarton: 16.82},
    "522-strPas-Bio250N-30-Tail": {unitsPerCarton: 350, weightPerCarton: 15.203},
    "518-Bio Twine Pas 380-4-Turbo": {unitsPerCarton: 550, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-5-Turbo": {unitsPerCarton: 550, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-6-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-7-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-8-Turbo": {unitsPerCarton: 470, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-9-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-10-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-11-Turbo": {unitsPerCarton: 440, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-12-Turbo": {unitsPerCarton: 420, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-13-Turbo": {unitsPerCarton: 360, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-14-Turbo": {unitsPerCarton: 360, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-15-Turbo": {unitsPerCarton: 340, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-16-Turbo": {unitsPerCarton: 310, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-17-Turbo": {unitsPerCarton: 310, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-18-Turbo": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-19-Turbo": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-20-Turbo": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-21-Turbo": {unitsPerCarton: 270, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-22-Turbo": {unitsPerCarton: 270, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-23-Turbo": {unitsPerCarton: 250, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-24-Turbo": {unitsPerCarton: 250, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-25-Turbo": {unitsPerCarton: 250, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-26-Turbo": {unitsPerCarton: 230, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-27-Turbo": {unitsPerCarton: 230, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-28-Turbo": {unitsPerCarton: 230, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-29-Turbo": {unitsPerCarton: 230, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-30-Turbo": {unitsPerCarton: 200, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-31-Turbo": {unitsPerCarton: 200, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-32-Turbo": {unitsPerCarton: 200, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-4-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-5-Turbo": {unitsPerCarton: 500, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-6-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-7-Turbo": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-8-Turbo": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-9-Turbo": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-10-Turbo": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-11-Turbo": {unitsPerCarton: 350, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-12-Turbo": {unitsPerCarton: 350, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-13-Turbo": {unitsPerCarton: 350, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-14-Turbo": {unitsPerCarton: 310, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-15-Turbo": {unitsPerCarton: 310, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-16-Turbo": {unitsPerCarton: 310, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-17-Turbo": {unitsPerCarton: 290, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-18-Turbo": {unitsPerCarton: 290, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-19-Turbo": {unitsPerCarton: 290, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-20-Turbo": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-21-Turbo": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-22-Turbo": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-23-Turbo": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-24-Turbo": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-25-Turbo": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-26-Turbo": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-27-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-28-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-29-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-30-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-31-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "522-Bio Twine Pas 380-32-Turbo": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-4-Tail": {unitsPerCarton: 500, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-5-Tail": {unitsPerCarton: 500, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-6-Tail": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-7-Tail": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-8-Tail": {unitsPerCarton: 450, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-9-Tail": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-10-Tail": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-11-Tail": {unitsPerCarton: 400, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-12-Tail": {unitsPerCarton: 370, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-13-Tail": {unitsPerCarton: 370, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-14-Tail": {unitsPerCarton: 370, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-15-Tail": {unitsPerCarton: 350, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-16-Tail": {unitsPerCarton: 350, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-17-Tail": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-18-Tail": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-19-Tail": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-20-Tail": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-21-Tail": {unitsPerCarton: 300, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-22-Tail": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-23-Tail": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-24-Tail": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-25-Tail": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-26-Tail": {unitsPerCarton: 280, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-27-Tail": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-28-Tail": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-29-Tail": {unitsPerCarton: 260, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-30-Tail": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-31-Tail": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "518-Bio Twine Pas 380-32-Tail": {unitsPerCarton: 240, weightPerCarton: 14.0},
    "518-strPas-Bio390N-5-Turbo": {unitsPerCarton: 800, weightPerCarton: 22.841},
    "518-strPas-Bio390N-6-Turbo": {unitsPerCarton: 800, weightPerCarton: 23.641},
    "518-strPas-Bio390N-7-Turbo": {unitsPerCarton: 800, weightPerCarton: 24.441},
    "518-strPas-Bio390N-8-Turbo": {unitsPerCarton: 750, weightPerCarton: 23.711},
    "518-strPas-Bio390N-9-Turbo": {unitsPerCarton: 700, weightPerCarton: 22.881},
    "518-strPas-Bio390N-10-Turbo": {unitsPerCarton: 700, weightPerCarton: 23.581},
    "518-strPas-Bio390N-11-Turbo": {unitsPerCarton: 700, weightPerCarton: 24.281},
    "518-strPas-Bio390N-12-Turbo": {unitsPerCarton: 650, weightPerCarton: 23.251},
    "518-strPas-Bio390N-13-Turbo": {unitsPerCarton: 650, weightPerCarton: 23.901},
    "518-strPas-Bio390N-14-Turbo": {unitsPerCarton: 600, weightPerCarton: 22.721},
    "518-strPas-Bio390N-15-Turbo": {unitsPerCarton: 550, weightPerCarton: 21.441},
    "518-strPas-Bio390N-16-Turbo": {unitsPerCarton: 500, weightPerCarton: 20.061},
    "518-strPas-Bio390N-17-Turbo": {unitsPerCarton: 400, weightPerCarton: 16.601},
    "518-strPas-Bio390N-18-Turbo": {unitsPerCarton: 400, weightPerCarton: 17.001},
    "518-strPas-Bio390N-19-Turbo": {unitsPerCarton: 400, weightPerCarton: 17.401},
    "518-strPas-Bio390N-20-Turbo": {unitsPerCarton: 400, weightPerCarton: 17.801},
    "518-strPas-Bio390N-21-Turbo": {unitsPerCarton: 400, weightPerCarton: 18.201},
    "518-strPas-Bio390N-22-Turbo": {unitsPerCarton: 400, weightPerCarton: 18.601},
    "518-strPas-Bio390N-23-Turbo": {unitsPerCarton: 400, weightPerCarton: 19.001},
    "518-strPas-Bio390N-24-Turbo": {unitsPerCarton: 400, weightPerCarton: 19.401},
    "518-strPas-Bio390N-25-Turbo": {unitsPerCarton: 350, weightPerCarton: 17.421},
    "522-strPas-Bio390N-5-Turbo": {unitsPerCarton: 750, weightPerCarton: 22.873},
    "522-strPas-Bio390N-6-Turbo": {unitsPerCarton: 750, weightPerCarton: 23.623},
    "522-strPas-Bio390N-7-Turbo": {unitsPerCarton: 700, weightPerCarton: 22.798},
    "522-strPas-Bio390N-8-Turbo": {unitsPerCarton: 600, weightPerCarton: 20.248},
    "522-strPas-Bio390N-9-Turbo": {unitsPerCarton: 500, weightPerCarton: 17.498},
    "522-strPas-Bio390N-10-Turbo": {unitsPerCarton: 500, weightPerCarton: 17.998},
    "522-strPas-Bio390N-11-Turbo": {unitsPerCarton: 450, weightPerCarton: 16.723},
    "522-strPas-Bio390N-12-Turbo": {unitsPerCarton: 430, weightPerCarton: 16.443},
    "522-strPas-Bio390N-13-Turbo": {unitsPerCarton: 430, weightPerCarton: 16.873},
    "522-strPas-Bio390N-14-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.303},
    "522-strPas-Bio390N-15-Turbo": {unitsPerCarton: 430, weightPerCarton: 17.733},
    "522-strPas-Bio390N-16-Turbo": {unitsPerCarton: 430, weightPerCarton: 18.163},
    "522-strPas-Bio390N-17-Turbo": {unitsPerCarton: 400, weightPerCarton: 17.348},
    "522-strPas-Bio390N-18-Turbo": {unitsPerCarton: 400, weightPerCarton: 17.748},
    "522-strPas-Bio390N-19-Turbo": {unitsPerCarton: 400, weightPerCarton: 18.148},
    "522-strPas-Bio390N-20-Turbo": {unitsPerCarton: 400, weightPerCarton: 18.548},
    "522-strPas-Bio390N-21-Turbo": {unitsPerCarton: 400, weightPerCarton: 18.948},
    "522-strPas-Bio390N-22-Turbo": {unitsPerCarton: 400, weightPerCarton: 19.348},
    "522-strPas-Bio390N-23-Turbo": {unitsPerCarton: 350, weightPerCarton: 17.373},
    "522-strPas-Bio390N-24-Turbo": {unitsPerCarton: 350, weightPerCarton: 17.723},
    "522-strPas-Bio390N-25-Turbo": {unitsPerCarton: 350, weightPerCarton: 18.073},
    "522-strPas-Bio390N-5-Tail": {unitsPerCarton: 650, weightPerCarton: 19.923},
    "522-strPas-Bio390N-6-Tail": {unitsPerCarton: 650, weightPerCarton: 20.573},
    "522-strPas-Bio390N-7-Tail": {unitsPerCarton: 600, weightPerCarton: 19.648},
    "522-strPas-Bio390N-8-Tail": {unitsPerCarton: 600, weightPerCarton: 20.248},
    "522-strPas-Bio390N-9-Tail": {unitsPerCarton: 550, weightPerCarton: 19.173},
    "522-strPas-Bio390N-10-Tail": {unitsPerCarton: 550, weightPerCarton: 19.723},
    "522-strPas-Bio390N-11-Tail": {unitsPerCarton: 500, weightPerCarton: 18.498},
    "522-strPas-Bio390N-12-Tail": {unitsPerCarton: 500, weightPerCarton: 18.998},
    "522-strPas-Bio390N-13-Tail": {unitsPerCarton: 500, weightPerCarton: 19.498},
    "522-strPas-Bio390N-14-Tail": {unitsPerCarton: 450, weightPerCarton: 18.073},
    "522-strPas-Bio390N-15-Tail": {unitsPerCarton: 450, weightPerCarton: 18.523},
    "522-strPas-Bio390N-16-Tail": {unitsPerCarton: 400, weightPerCarton: 16.948},
    "522-strPas-Bio390N-17-Tail": {unitsPerCarton: 400, weightPerCarton: 17.348},
    "522-strPas-Bio390N-18-Tail": {unitsPerCarton: 400, weightPerCarton: 17.748},
    "522-strPas-Bio390N-19-Tail": {unitsPerCarton: 400, weightPerCarton: 18.148},
    "522-strPas-Bio390N-20-Tail": {unitsPerCarton: 400, weightPerCarton: 18.548},
    "522-strPas-Bio390N-21-Tail": {unitsPerCarton: 400, weightPerCarton: 18.948},
    "522-strPas-Bio390N-22-Tail": {unitsPerCarton: 400, weightPerCarton: 19.348},
    "522-strPas-Bio390N-23-Tail": {unitsPerCarton: 400, weightPerCarton: 19.748},
    "522-strPas-Bio390N-24-Tail": {unitsPerCarton: 384, weightPerCarton: 19.372},
    "522-strPas-Bio390N-25-Tail": {unitsPerCarton: 384, weightPerCarton: 19.756},
    "522-1000-9-No Free Fall": {unitsPerCarton: 390, weightPerCarton: 13.813},
    "522-1000-10-No Free Fall": {unitsPerCarton: 370, weightPerCarton: 13.513},
    "522-1000-11-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 11.753},
    "522-1000-12-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 12.063},
    "522-1000-13-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 12.373},
    "522-1000-14-No Free Fall": {unitsPerCarton: 300, weightPerCarton: 12.298},
    "522-1000-15-No Free Fall": {unitsPerCarton: 280, weightPerCarton: 11.808},
    "522-1000-16-No Free Fall": {unitsPerCarton: 280, weightPerCarton: 12.088},
    "522-1000-17-No Free Fall": {unitsPerCarton: 290, weightPerCarton: 12.783},
    "522-1000-18-No Free Fall": {unitsPerCarton: 290, weightPerCarton: 13.073},
    "522-1000-19-No Free Fall": {unitsPerCarton: 280, weightPerCarton: 12.928},
    "522-1000-20-No Free Fall": {unitsPerCarton: 270, weightPerCarton: 12.763},
    "522-1200-8-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 19.432},
    "522-1200-9-No Free Fall": {unitsPerCarton: 580, weightPerCarton: 19.291},
    "522-1200-10-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 17.148},
    "522-1200-11-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 17.563},
    "522-1200-12-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 17.978},
    "522-1200-13-No Free Fall": {unitsPerCarton: 480, weightPerCarton: 17.687},
    "522-1200-14-No Free Fall": {unitsPerCarton: 450, weightPerCarton: 17.002},
    "522-1200-15-No Free Fall": {unitsPerCarton: 420, weightPerCarton: 16.267},
    "522-1200-16-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 13.971},
    "522-1200-17-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.261},
    "522-1200-18-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 12.974},
    "522-1200-19-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 13.232},
    "522-1200-20-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 13.489},
    "522-1500-12-No Free Fall": {unitsPerCarton: 550, weightPerCarton: 18.645},
    "522-1500-13-No Free Fall": {unitsPerCarton: 540, weightPerCarton: 18.681},
    "522-1500-14-No Free Fall": {unitsPerCarton: 420, weightPerCarton: 14.978},
    "522-1500-16-No Free Fall": {unitsPerCarton: 420, weightPerCarton: 15.54},
    "522-1500-18-No Free Fall": {unitsPerCarton: 420, weightPerCarton: 16.103},
    "522-1500-19-No Free Fall": {unitsPerCarton: 400, weightPerCarton: 15.64},
    "522-1500-21-No Free Fall": {unitsPerCarton: 310, weightPerCarton: 12.705},
    "518-1000-9-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 16.561},
    "518-1000-10-No Free Fall": {unitsPerCarton: 400, weightPerCarton: 13.801},
    "518-1000-11-No Free Fall": {unitsPerCarton: 380, weightPerCarton: 13.529},
    "518-1000-12-No Free Fall": {unitsPerCarton: 380, weightPerCarton: 13.909},
    "518-1000-13-No Free Fall": {unitsPerCarton: 360, weightPerCarton: 13.577},
    "518-1000-14-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 13.571},
    "518-1000-15-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 13.921},
    "518-1000-16-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.271},
    "518-1000-17-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.621},
    "518-1000-18-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.971},
    "518-1000-19-No Free Fall": {unitsPerCarton: 320, weightPerCarton: 14.073},
    "518-1000-20-No Free Fall": {unitsPerCarton: 320, weightPerCarton: 14.393},
    "518-1200-5-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 16.811},
    "518-1200-6-No Free Fall": {unitsPerCarton: 650, weightPerCarton: 18.688},
    "518-1200-7-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 17.807},
    "518-1200-8-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 18.305},
    "518-1200-9-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 18.803},
    "518-1200-10-No Free Fall": {unitsPerCarton: 550, weightPerCarton: 17.756},
    "518-1200-11-No Free Fall": {unitsPerCarton: 550, weightPerCarton: 18.212},
    "518-1200-12-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 17.041},
    "518-1200-13-No Free Fall": {unitsPerCarton: 480, weightPerCarton: 16.788},
    "518-1200-14-No Free Fall": {unitsPerCarton: 470, weightPerCarton: 16.844},
    "518-1200-15-No Free Fall": {unitsPerCarton: 450, weightPerCarton: 16.534},
    "518-1200-16-No Free Fall": {unitsPerCarton: 450, weightPerCarton: 16.907},
    "518-1200-17-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 13.609},
    "518-1200-18-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 13.9},
    "518-1200-19-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.191},
    "518-1200-20-No Free Fall": {unitsPerCarton: 350, weightPerCarton: 14.481},
    "518-1300-9-No Free Fall": {unitsPerCarton: 800, weightPerCarton: 24.385},
    "518-1300-12-No Free Fall": {unitsPerCarton: 415, weightPerCarton: 13.975},
    "518-1300-16-No Free Fall": {unitsPerCarton: 360, weightPerCarton: 13.332},
    "518-1500-10-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 18.341},
    "518-1500-12-No Free Fall": {unitsPerCarton: 600, weightPerCarton: 19.145},
    "518-1500-13-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 16.416},
    "518-1500-14-No Free Fall": {unitsPerCarton: 500, weightPerCarton: 16.751},
    "518-1500-17-No Free Fall": {unitsPerCarton: 380, weightPerCarton: 13.677},
    "518-1500-20-No Free Fall": {unitsPerCarton: 360, weightPerCarton: 13.721},
    "default": {unitsPerCarton: 400, weightPerCarton: 14.0}
};

// ============================================
// QUOTE DATA MODULE
// ============================================

const QuoteData = {
    items: [],
    nextId: 1,
    
    createEmptyItem(id) {
        // Create a new empty item without adding to items array
        return {
            id: id || this.nextId,
            grower: '',
            shipTo: '',
            reqDate: '',
            hookType: '',
            hookSize: '',
            twineType: '',
            wireLength: '',
            freeFallLength: '',
            totalLength: 0,
            crop: '',
            colors: [],
            colorMode: 'single',  // 'single' or 'sequence'
            colorUIMode: 'single',  // UI state: 'single' or 'sequence'
            quantity: '',
            actualUnits: 0,
            actualBoxes: 0,
            totalPallets: 0,
            weight: 0,
            pn: ''
        };
    },
    
    addItem() {
        const item = {
            id: this.nextId++,
            itemNum: this.nextId - 1,  // Same as id for now
            grower: '',
            shipTo: '',
            reqDate: '',
            estimatedDeliveryDate: '',
            hookType: '',
            hookSize: '',
            twineType: '',
            wireLength: '',
            freeFallLength: '',
            totalLength: 0,
            crop: '',
            colors: [],
            colorMode: 'single',  // 'single' or 'sequence'
            colorUIMode: 'single',  // UI state: 'single' or 'sequence'
            quantity: '',
            actualUnits: 0,
            unitsPerBox: 0,
            actualBoxes: 0,
            totalPallets: 0,
            weight: 0,
            pn: '',
            transportationType1: '',
            transportationCost1: 0,
            transportationType2: '',
            transportationCost2: 0,
            incoterms: '',
            currency: '',
            lastPrice: 0
        };
        this.items.push(item);
        return item;
    },
    
    deleteItem(id) {
        const index = this.items.findIndex(i => i.id === id);
        if (index > -1) {
            this.items.splice(index, 1);
        }
    },
    
    getItem(id) {
        return this.items.find(i => i.id === id);
    },
    
    updateItem(id, field, value) {
        const item = this.getItem(id);
        if (item) {
            item[field] = value;
            
            // Only recalculate and render if necessary
            if (field === 'wireLength' || field === 'freeFallLength' || field === 'hookType' || 
                field === 'hookSize' || field === 'twineType' || field === 'quantity') {
                this.calculate(id);
            }
            
            this.save();
            
            // Don't render for simple field updates to prevent losing focus
            // Only render when structure changes
        }
    },
    

    mapTwineTypeToDBKey(twineType) {
        // Map UI twine type to DB key
        const mapping = {
            'Bio250': 'strPas-Bio250N',
            'Bio390': 'strPas-Bio390N'
        };
        return mapping[twineType] || twineType;
    },
    
    
    smartRoundTotalLength(value) {
        // Round to nearest 0.5
        // 0.1-0.4 ‚Üí round down
        // 0.5-0.9 ‚Üí round up
        const decimal = value - Math.floor(value);
        
        if (decimal >= 0.5) {
            return Math.ceil(value);
        } else if (decimal >= 0.1) {
            return Math.floor(value);
        } else {
            return Math.round(value);
        }
    },
    

    validateWireLength(twineType, wireLength, freeFallLength) {
        if (!twineType) return { wire: true, ff: true, total: true };
        
        const wireRange = CONFIG.WIRE_RANGES[twineType];
        const ffRange = CONFIG.FREE_FALL_RANGE;
        
        const wire = parseFloat(wireLength);
        const ff = parseFloat(freeFallLength);
        const total = wire + ff;
        
        const wireValid = !isNaN(wire) && wire >= wireRange.min && wire <= wireRange.max;
        const ffValid = !isNaN(ff) && ff >= ffRange.min && ff <= ffRange.max;
        const totalValid = wireValid && ffValid;
        
        return { wire: wireValid, ff: ffValid, total: totalValid };
    },
    
    calculate(id) {
        const item = this.getItem(id);
        if (!item) return;
        
        // Total Length
        const wire = parseFloat(item.wireLength) || 0;
        const ff = parseFloat(item.freeFallLength) || 0;
        item.totalLength = wire + ff;
        
        // Only calculate units/box if ALL required fields are filled
        // NOTE: freeFallLength can be 0 (that's valid!)
        if (!item.hookSize || !item.twineType || !item.hookType || !item.wireLength || 
            item.freeFallLength === '' || item.freeFallLength === null || item.freeFallLength === undefined) {
            item.unitsPerBox = null;
            item.actualBoxes = 0;
            item.weight = 0;
            this.generatePN(id);
            return;
        }
        
        // Get carton data
        const hookCode = item.hookSize === '180' ? '518' : '522';
        const totalWire = QuoteData.smartRoundTotalLength(item.totalLength);
        const dbTwineType = this.mapTwineTypeToDBKey(item.twineType);
        const key = `${hookCode}-${dbTwineType}-${totalWire}-${item.hookType}`;
        const cartonData = CARTON_DB[key];
        
        // If not found, show N/A instead of default
        if (!cartonData) {
            item.unitsPerBox = 'N/A';
            item.actualBoxes = 0;
            item.weight = 0;
            this.generatePN(id);
            return;
        }
        
        // Store units per box for display
        item.unitsPerBox = cartonData ? cartonData.unitsPerCarton : null;
        
        // Calculate actual units (rounded to full boxes)
        const requestedQty = parseInt(item.quantity) || 0;
        if (requestedQty > 0 && cartonData) {
            const cartonsNeeded = Math.ceil(requestedQty / cartonData.unitsPerCarton);
            item.actualUnits = cartonsNeeded * cartonData.unitsPerCarton;
            item.unitsPerBox = cartonData.unitsPerCarton;
            item.actualBoxes = cartonsNeeded;
            
            // Calculate weight
            item.weight = item.actualBoxes * cartonData.weightPerCarton;
        } else {
            item.actualUnits = 0;
            item.actualBoxes = 0;
            item.weight = 0;
        }
        
        // Generate PN
        this.generatePN(id);
    },
    
    generatePN(id) {
        const item = this.getItem(id);
        if (!item || !item.hookSize || !item.hookType || !item.twineType || !item.wireLength) {
            item.pn = '';
            return;
        }
        
        // PN Format: 5[hookSize][type][wire]+[ff][colors]-[twineCode]
        // Single: 518pk20+2b-15
        // Sequence: 522tl20+2b2y3-12
        // Bio: 522pk15+3bio250-w
        
        // Convert hookSize: 180‚Üí18, 220‚Üí22
        let hookSize = String(item.hookSize);
        if (hookSize === '180') {
            hookSize = '18';
        } else if (hookSize === '220') {
            hookSize = '22';
        }
        
        const type = item.hookType === 'Turbo' ? 'pk' : item.hookType === 'Tail' ? 'tl' : 'nf';
        const wire = item.wireLength || '0';
        const ff = item.freeFallLength || '0';
        
        // Twine code - convert 1000‚Üí10, 1200‚Üí12, 1300‚Üí13, 1500‚Üí15
        let twineCode = '';
        if (item.twineType === 'Bio250') {
            twineCode = 'bio250';
        } else if (item.twineType === 'Bio390') {
            twineCode = 'bio390';
        } else if (item.twineType === '1000') {
            twineCode = '10';
        } else if (item.twineType === '1200') {
            twineCode = '12';
        } else if (item.twineType === '1300') {
            twineCode = '13';
        } else if (item.twineType === '1500') {
            twineCode = '15';
        } else {
            twineCode = item.twineType; // fallback
        }
        
        // Colors
        let colorStr = '';
        if (item.colors.length === 0) {
            colorStr = '';
        } else if (item.colors.length === 1) {
            // Single color - just the letter
            colorStr = item.colors[0].color.charAt(0).toLowerCase();
        } else {
            // Sequence - color+qty for each: b2y3r1
            colorStr = item.colors.map(c => {
                const letter = c.color.charAt(0).toLowerCase();
                return `${letter}${c.quantity}`;
            }).join('');
        }
        
        // Build PN
        // Format: 5[hookSize][type][wire]+[ff][colors]-[twineCode]
        // But for Bio: 5[hookSize][type][wire]+[ff][twineCode]-[color]
        
        if (item.twineType === 'Bio250' || item.twineType === 'Bio390') {
            // Bio format: 522pk15+3bio250-w
            item.pn = `5${hookSize}${type}${wire}+${ff}${twineCode}-${colorStr}`;
        } else {
            // Regular format: 518pk20+2b-15
            item.pn = `5${hookSize}${type}${wire}+${ff}${colorStr}-${twineCode}`;
        }
    },
    
    save() {
        localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(this.items));
    },
    
    load() {
        const data = localStorage.getItem(CONFIG.STORAGE_KEY);
        if (data) {
            this.items = JSON.parse(data);
            this.nextId = Math.max(...this.items.map(i => i.id), 0) + 1;
        } else {
            // Start with one empty row
            this.addItem();
        }
    },
    
    clear() {
        this.items = [];
        this.nextId = 1;
        this.save();
    },
    
    getSummary() {
        return {
            totalItems: this.items.length,
            totalUnits: this.items.reduce((sum, i) => sum + i.actualUnits, 0),
            totalCartons: this.items.reduce((sum, i) => sum + i.actualBoxes, 0),
            totalWeight: this.items.reduce((sum, i) => sum + i.weight, 0)
        };
    }
};

// ============================================
// QUOTE UI MODULE
// ============================================

const QuoteUI = {
    currentColorsRow: null,
    currentColorsMode: null,
    
    init() {
        // Always start with one empty item (clean form)
        QuoteData.items = [];
        QuoteData.nextId = 1;
        QuoteData.addItem();
        
        // Load saved date format preference
        const savedFormat = localStorage.getItem('preferredDateFormat') || 'DD/MM/YYYY'; // Changed default to DD/MM/YYYY
        const selector = document.getElementById('dateFormatSelector');
        if (selector) {
            selector.value = savedFormat;
        }
        
        // Setup character counter for special requests
        const specialRequests = document.getElementById('specialRequests');
        const charCount = document.getElementById('charCount');
        if (specialRequests && charCount) {
            specialRequests.addEventListener('input', function() {
                charCount.textContent = this.value.length;
            });
        }
        
        this.render();
        this.updateSummary();
    },
    

    updateSummary() {
        const totalUnits = QuoteData.items.reduce((sum, item) => sum + (parseInt(item.quantity) || 0), 0);
        const totalBoxes = QuoteData.items.reduce((sum, item) => sum + (item.actualBoxes || 0), 0);
        
        document.getElementById('summaryItems').textContent = QuoteData.items.length;
        document.getElementById('summaryUnits').textContent = totalUnits.toLocaleString();
        document.getElementById('summaryBoxes').textContent = totalBoxes;
    },
    
    handleDateChange(id, isoDate) {
        // Update the item with ISO date
        QuoteData.updateItem(id, 'reqDate', isoDate);
        
        // Update the display input
        const displayInput = document.querySelector(`.date-display-input[data-item-id="${id}"]`);
        if (displayInput) {
            displayInput.value = this.formatDateForDisplay(isoDate);
        }
        
        this.updateSummary();
    },
    
    changeDateFormat(format) {
        // Store preferred date format
        localStorage.setItem('preferredDateFormat', format);
        
        // Update all date display inputs
        document.querySelectorAll('.date-display-input').forEach(input => {
            const itemId = input.getAttribute('data-item-id');
            const item = QuoteData.getItem(parseInt(itemId));
            if (item && item.reqDate) {
                input.value = this.formatDateForDisplay(item.reqDate);
            }
            input.placeholder = 'üìÖ ' + format;
        });
        
        this.showAlert(`Date format changed to ${format}`, 'success');
    },
    
    formatDateForDisplay(dateStr) {
        // Convert YYYY-MM-DD to display format (DD/MM/YYYY or MM/DD/YYYY)
        if (!dateStr) return '';
        
        const format = localStorage.getItem('preferredDateFormat') || 'DD/MM/YYYY';
        const parts = dateStr.split('-'); // YYYY-MM-DD
        
        if (parts.length !== 3) return dateStr;
        
        const [year, month, day] = parts;
        
        if (format === 'MM/DD/YYYY') {
            return `${month}/${day}/${year}`;
        } else {
            return `${day}/${month}/${year}`;
        }
    },
    
    handleDateInput(id, value) {
        // Parse date from display format and store as YYYY-MM-DD
        if (!value) return;
        
        const format = localStorage.getItem('preferredDateFormat') || 'DD/MM/YYYY';
        
        // Remove any non-digit/slash characters
        value = value.replace(/[^\d/]/g, '');
        
        const parts = value.split('/');
        if (parts.length !== 3) {
            this.showAlert('Invalid date format. Use ' + format, 'warning');
            return;
        }
        
        let day, month, year;
        
        if (format === 'MM/DD/YYYY') {
            [month, day, year] = parts;
        } else {
            [day, month, year] = parts;
        }
        
        // Validate
        const dayNum = parseInt(day);
        const monthNum = parseInt(month);
        const yearNum = parseInt(year);
        
        if (dayNum < 1 || dayNum > 31 || monthNum < 1 || monthNum > 12 || yearNum < 2024) {
            this.showAlert('Invalid date values', 'warning');
            return;
        }
        
        // Store as YYYY-MM-DD
        const isoDate = `${yearNum}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
        QuoteData.updateItem(id, 'reqDate', isoDate);
        this.updateSummary();
    },
    
    updateTotalTwine(id) {
        const item = QuoteData.getItem(id);
        if (!item) return;
        
        // Calculate total twine
        const wire = parseFloat(item.wireLength) || 0;
        const ff = parseFloat(item.freeFallLength) || 0;
        item.totalLength = wire + ff;
        
        // CRITICAL: Save immediately
        QuoteData.save();
        
        // Recalculate if all fields are ready
        QuoteData.calculate(id);

        // Note: render() will update display on blur
    },
    
    addRow() {
        QuoteData.addItem();
        this.render();
        this.updateSummary();
    },
    
    duplicateRow(id) {
        const item = QuoteData.getItem(id);
        if (item) {
            // Create new item with explicit field copying
            const newItem = { 
                ...item,
                id: Date.now(),
                itemNum: Date.now(),
                // Explicitly copy quantity to ensure it's preserved
                quantity: item.quantity,
                actualUnits: item.actualUnits,
                actualBoxes: item.actualBoxes,
                // Deep copy colors array
                colors: [...(item.colors || [])]
            };
            QuoteData.items.push(newItem);
            QuoteData.save();
            this.render();
            this.updateSummary();
        }
    },
    
    // Smart Duplicate Feature
    // Multi-Select Duplicate System
    selectionMode: false,
    selectedRows: new Set(),
    bannerDismissed: false,
    
    toggleSelectionMode() {
        if (QuoteData.items.length === 0) {
            this.showAlert('No items to duplicate. Please add items first.', 'warning', false);
            return;
        }
        
        this.selectionMode = !this.selectionMode;
        const btn = document.getElementById('duplicateBtn');
        
        if (this.selectionMode) {
            // Entering selection mode
            btn.textContent = '‚ùå Exit Selection';
            btn.className = 'btn btn-secondary';
            this.selectedRows.clear();
            this.bannerDismissed = false; // Reset banner
            this.render();
            
            // Show instructions modal
            document.getElementById('instructionsModal').classList.add('show');
        } else {
            // Exiting selection mode
            btn.textContent = 'üìã Duplicate Item';
            btn.className = 'btn btn-secondary';
            this.selectedRows.clear();
            this.render();
        }
        
        this.updateDuplicateButton();
    },
    
    dismissBanner() {
        this.bannerDismissed = true;
        this.render();
    },
    
    closeInstructionsModal() {
        document.getElementById('instructionsModal').classList.remove('show');
    },
    
    toggleRowSelection(itemId, checked) {
        if (checked) {
            this.selectedRows.add(itemId);
        } else {
            this.selectedRows.delete(itemId);
        }
        
        this.render();
        this.updateDuplicateButton();
        this.updateSelectAllCheckbox();
    },
    
    toggleSelectAll(checked) {
        if (checked) {
            // Select all
            QuoteData.items.forEach(item => {
                this.selectedRows.add(item.id);
            });
        } else {
            // Deselect all
            this.selectedRows.clear();
        }
        
        this.render();
        this.updateDuplicateButton();
    },
    
    updateSelectAllCheckbox() {
        const checkbox = document.getElementById('selectAllCheckbox');
        if (checkbox) {
            const totalItems = QuoteData.items.length;
            const selectedCount = this.selectedRows.size;
            
            if (selectedCount === 0) {
                checkbox.checked = false;
                checkbox.indeterminate = false;
            } else if (selectedCount === totalItems) {
                checkbox.checked = true;
                checkbox.indeterminate = false;
            } else {
                checkbox.checked = false;
                checkbox.indeterminate = true;
            }
        }
    },
    
    updateDuplicateButton() {
        // Add or update duplicate button
        let duplicateActionBtn = document.getElementById('duplicateActionBtn');
        const count = this.selectedRows.size;
        
        if (this.selectionMode && count > 0) {
            if (!duplicateActionBtn) {
                // Create button if doesn't exist
                const btnContainer = document.querySelector('.btn.btn-secondary').parentElement;
                duplicateActionBtn = document.createElement('button');
                duplicateActionBtn.id = 'duplicateActionBtn';
                duplicateActionBtn.className = 'btn btn-primary';
                duplicateActionBtn.onclick = () => this.openConfirmModal();
                duplicateActionBtn.style.padding = '12px 35px';
                duplicateActionBtn.style.fontSize = '1rem';
                btnContainer.appendChild(duplicateActionBtn);
            }
            
            duplicateActionBtn.textContent = `‚úì Duplicate ${count} Row${count > 1 ? 's' : ''}`;
            duplicateActionBtn.style.display = 'inline-block';
        } else if (duplicateActionBtn) {
            duplicateActionBtn.style.display = 'none';
        }
    },
    
    openConfirmModal() {
        const count = this.selectedRows.size;
        if (count === 0) return;
        
        document.getElementById('confirmRowCount').textContent = count;
        document.getElementById('confirmNewCount').textContent = count;
        document.getElementById('duplicateConfirmModal').classList.add('show');
    },
    
    closeConfirmModal() {
        document.getElementById('duplicateConfirmModal').classList.remove('show');
    },
    
    executeDuplicate() {
        const selectedIds = Array.from(this.selectedRows);
        if (selectedIds.length === 0) return;
        
        this.closeConfirmModal();
        
        // Get original items
        const originalItems = selectedIds.map(id => 
            QuoteData.items.find(item => item.id === id)
        ).filter(Boolean);
        
        // Create duplicates
        const newItems = originalItems.map(item => ({
            ...item,
            id: QuoteData.nextId++,
            quantity: '' // Clear quantity
        }));
        
        // Add to items
        QuoteData.items.push(...newItems);
        QuoteData.save();
        
        // Get IDs for highlighting
        const originalIds = selectedIds;
        const newIds = newItems.map(item => item.id);
        const allHighlightIds = [...originalIds, ...newIds];
        
        // Exit selection mode
        this.selectionMode = false;
        this.selectedRows.clear();
        this.bannerDismissed = false; // Reset banner for next time
        const btn = document.getElementById('duplicateBtn');
        btn.textContent = 'üìã Duplicate Item';
        
        // Render
        this.render();
        this.updateSummary();
        this.updateDuplicateButton();
        
        // Highlight all rows (originals + new)
        setTimeout(() => {
            const table = document.querySelector('.quote-table tbody');
            if (table) {
                const rows = table.querySelectorAll('tr');
                
                rows.forEach(row => {
                    const itemId = parseInt(row.dataset.itemId);
                    if (allHighlightIds.includes(itemId)) {
                        row.classList.add('duplicate-highlight');
                    }
                });
                
                // Scroll to first new row
                const firstNewId = newIds[0];
                const firstNewRow = Array.from(rows).find(row => 
                    parseInt(row.dataset.itemId) === firstNewId
                );
                if (firstNewRow) {
                    firstNewRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                
                // Remove highlights after 4 seconds
                setTimeout(() => {
                    document.querySelectorAll('.duplicate-highlight').forEach(row => {
                        row.classList.remove('duplicate-highlight');
                    });
                }, 4000);
            }
        }, 100);
        
        // Show alert
        this.showAlert(`‚úì ${originalIds.length} row${originalIds.length > 1 ? 's' : ''} duplicated successfully`, 'success', false);
    },
    
    deleteRow(id) {
        if (QuoteData.items.length === 1) {
            this.showAlert('Cannot delete the first item. At least one item is required.', 'warning', false);
            return;
        }
        
        QuoteData.items = QuoteData.items.filter(item => item.id !== id);
        QuoteData.save();
        this.render();
        this.updateSummary();
    },
    
    clearAll() {
        if (confirm('Are you sure you want to clear all items? This cannot be undone.')) {
            QuoteData.items = [];
            QuoteData.save();
            QuoteData.addItem(); // Add one empty row
            this.render();
            this.updateSummary();
            this.showAlert('All items cleared', 'success');
        }
    },
    
    generateQuote() {
        // Validate all items
        const errors = [];
        
        QuoteData.items.forEach((item, index) => {
            const missing = [];
            
            // Grower is optional - don't validate
            if (!item.shipTo) missing.push('Ship To');
            if (!item.reqDate) missing.push('Req. Delivery Date');
            if (!item.hookType) missing.push('Hook Type');
            if (!item.hookSize) missing.push('Hook Size');
            if (!item.twineType) missing.push('Twine Type');
            if (!item.wireLength) missing.push('Twine on Hook');
            if (!item.freeFallLength && item.freeFallLength !== 0) missing.push('Free Fall');
            if (!item.crop) missing.push('Crop');
            if (item.colors.length === 0) missing.push('Twine Color');
            if (!item.quantity) missing.push('Units');
            
            if (missing.length > 0) {
                errors.push(`Row ${index + 1} - Missing: ${missing.join(', ')}`);
            }
        });
        
        if (errors.length > 0) {
            const modal = document.getElementById('validationModal');
            const body = document.getElementById('validationModalBody');
            
            body.innerHTML = `
                <h3 style="color: #dc2626; margin-bottom: 15px;">‚ö†Ô∏è Required Fields Missing</h3>
                <ul style="list-style: none; padding: 0;">
                    ${errors.map(err => `<li style="padding: 8px; background: #fee; margin: 5px 0; border-radius: 4px;">${err}</li>`).join('')}
                </ul>
                <button class="btn btn-primary" onclick="document.getElementById('validationModal').classList.remove('show')" style="width: 60%; margin: 0 auto; display: block;">
                    Got it, I'll fix them
                </button>
            `;
            
            modal.classList.add('show');
            return;
        }
        
        // Generate quote and show success modal
        this.createQuoteAndShowModal();
    },
    
    createQuoteAndShowModal() {
        // Check if editing existing quote
        const quoteId = this.editingQuoteId || QuoteStorage.generateQuoteId();
        const today = new Date();
        
        // Collect all quote data
        const specialRequestsField = document.getElementById('specialRequests');
        const specialRequests = specialRequestsField ? specialRequestsField.value.trim() : '';
        
        const quoteData = {
            id: quoteId,
            dateCreated: today.toISOString(),
            items: QuoteData.items.map(item => ({...item})),
            specialRequests: specialRequests,
            summary: {
                totalItems: QuoteData.items.length,
                totalUnits: QuoteData.items.reduce((sum, item) => sum + (parseInt(item.quantity) || 0), 0),
                totalBoxes: QuoteData.items.reduce((sum, item) => sum + (item.actualBoxes || 0), 0)
            },
            status: 'Pending'
        };
        
        // Save to localStorage
        if (this.editingQuoteId) {
            QuoteStorage.updateQuote(quoteId, quoteData);
            this.editingQuoteId = null; // Clear edit mode
            
            // Reset Generate button
            const btn = document.getElementById('generateQuoteBtn');
            if (btn) {
                btn.innerHTML = 'üìã Generate Quote';
            }
            
            // Hide Cancel button
            const cancelBtn = document.getElementById('cancelEditBtn');
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
        } else {
            QuoteStorage.saveQuote(quoteData);
        }
        
        // Store current quote for email/download
        this.currentQuote = quoteData;
        
        // Show success modal
        this.showSuccessModal(quoteData);
    },
    
    showSuccessModal(quoteData) {
        const modal = document.getElementById('successModal');
        const body = document.getElementById('successModalBody');
        
        body.innerHTML = `
            <div style="background: #f0f9ff; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--success-green);">
                <p style="margin-bottom: 10px;"><strong>Quote ID:</strong> ${quoteData.id}</p>
                <p style="margin-bottom: 10px;"><strong>Date:</strong> ${new Date(quoteData.dateCreated).toLocaleDateString()}</p>
                <p style="margin-bottom: 10px;"><strong>Total Items:</strong> ${quoteData.summary.totalItems}</p>
                <p style="margin-bottom: 10px;"><strong>Total Units:</strong> ${quoteData.summary.totalUnits.toLocaleString()}</p>
                <p style="margin-bottom: 10px;"><strong>Total Boxes:</strong> ${quoteData.summary.totalBoxes}</p>
            </div>
            
            <div style="background: #e0f2fe; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; border-left: 4px solid var(--paskal-navy);">
                <p style="color: var(--paskal-navy); font-weight: 600; margin: 0;">
                    üì® This quote has been sent to Sales Manager for approval
                </p>
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="(async () => await QuoteUI.downloadExcelFile())()" style="flex: 1;">
                        üíæ Download Excel
                    </button>
                    <button class="btn btn-primary" onclick="(async () => await QuoteUI.downloadPDFFile())()" style="flex: 1;">
                        üìÑ Download PDF
                    </button>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="TabManager.viewMyOrders()" style="flex: 1;">
                        üëÅ View My Orders
                    </button>
                    <button class="btn btn-secondary" onclick="QuoteUI.closeSuccessModal(); TabManager.switchTab('create')" style="flex: 1;">
                        ‚úñÔ∏è Close
                    </button>
                </div>
            </div>
        `;
        
        modal.classList.add('show');
    },
    
    closeSuccessModal() {
        document.getElementById('successModal').classList.remove('show');
        
        // Clear form for new quote with one empty row
        QuoteData.items = [];
        QuoteData.nextId = 1;
        QuoteData.addItem();
        QuoteUI.editingQuoteId = null;
        
        // Clear any alerts
        const alertBox = document.getElementById('alertBox');
        if (alertBox) {
            alertBox.classList.remove('show');
        }
        
        // Reset button text
        const btn = document.getElementById('generateQuoteBtn');
        if (btn) {
            btn.innerHTML = 'üìã Generate Quote';
        }
        
        // Hide Cancel button
        const cancelBtn = document.getElementById('cancelEditBtn');
        if (cancelBtn) {
            cancelBtn.style.display = 'none';
        }
        
        // Clear special requests
        const specialRequests = document.getElementById('specialRequests');
        const charCount = document.getElementById('charCount');
        if (specialRequests) {
            specialRequests.value = '';
            if (charCount) charCount.textContent = '0';
        }
        
        // Return to MY ORDERS to see the created/updated quote
        TabManager.switchTab('orders');
        
        // Render fresh form with one empty row
        QuoteUI.render();
        QuoteUI.updateSummary();
        
        // Scroll to top
        window.scrollTo(0, 0);
    },
    
    clearEditMode() {
        // Clear edit mode WITHOUT confirmation
        this.editingQuoteId = null;
        
        // Clear any alerts
        const alertBox = document.getElementById('alertBox');
        if (alertBox) {
            alertBox.classList.remove('show');
        }
        
        // Clear form
        QuoteData.items = [];
        QuoteData.nextId = 1;
        QuoteData.addItem();
        
        // Reset Generate button
        const generateBtn = document.getElementById('generateQuoteBtn');
        if (generateBtn) {
            generateBtn.innerHTML = 'üìã Generate Quote';
        }
        
        // Hide Cancel button
        const cancelBtn = document.getElementById('cancelEditBtn');
        if (cancelBtn) {
            cancelBtn.style.display = 'none';
        }
        
        // Clear special requests
        const specialRequests = document.getElementById('specialRequests');
        const charCount = document.getElementById('charCount');
        if (specialRequests) {
            specialRequests.value = '';
            if (charCount) charCount.textContent = '0';
        }
        
        // Re-render
        this.render();
        this.updateSummary();
    },
    
    cancelEdit() {
        if (!confirm('Cancel editing? All unsaved changes will be lost.')) {
            return;
        }
        
        // User confirmed - clear edit mode
        this.clearEditMode();
        
        // Return to MY ORDERS
        TabManager.switchTab('orders');
        
        this.showAlert('Edit cancelled', 'info');
    },
    
    hasUnsavedData() {
        // Check if there's any data entered that hasn't been saved
        if (this.editingQuoteId) {
            return false; // In edit mode, different logic
        }
        
        if (QuoteData.items.length === 0) {
            return false; // No items
        }
        
        // Check if any item has data
        for (const item of QuoteData.items) {
            if (item.shipTo || item.reqDate || item.hookType || item.hookSize || 
                item.twineType || item.wireLength || item.freeFallLength || 
                item.crop || item.colors.length > 0 || item.quantity) {
                return true; // Has data
            }
        }
        
        // Check special requests
        const specialRequests = document.getElementById('specialRequests');
        if (specialRequests && specialRequests.value.trim()) {
            return true;
        }
        
        return false; // No meaningful data
    },
    
    saveDraft() {
        // Generate draft ID
        const draftId = QuoteStorage.generateQuoteId('DRAFT');
        const today = new Date();
        
        // Collect data
        const specialRequestsField = document.getElementById('specialRequests');
        const specialRequests = specialRequestsField ? specialRequestsField.value.trim() : '';
        
        const draftData = {
            id: draftId,
            dateCreated: today.toISOString(),
            items: QuoteData.items.map(item => ({...item})),
            specialRequests: specialRequests,
            summary: {
                totalItems: QuoteData.items.length,
                totalUnits: QuoteData.items.reduce((sum, item) => sum + (parseInt(item.quantity) || 0), 0),
                totalBoxes: QuoteData.items.reduce((sum, item) => sum + (item.actualBoxes || 0), 0)
            },
            status: 'Draft'
        };
        
        // Save to localStorage
        QuoteStorage.saveQuote(draftData);
        
        // Show success message
        this.showAlert('‚úì Draft saved successfully!', 'success');
        
        // Clear form
        QuoteData.items = [];
        QuoteData.nextId = 1;
        
        // Clear special requests
        if (specialRequestsField) {
            specialRequestsField.value = '';
            const charCount = document.getElementById('charCount');
            if (charCount) charCount.textContent = '0';
        }
        
        return true;
    },
    
    closeEmailModal() {
        document.getElementById('emailModal').classList.remove('show');
    },
    
    sendEmailWithFile() {
        const email = document.getElementById('emailInput').value.trim();
        
        if (!email) {
            this.showAlert('Please enter an email address', 'error');
            return;
        }
        
        if (!email.includes('@')) {
            this.showAlert('Please enter a valid email address', 'error');
            return;
        }
        
        // Generate Excel file
        const excelBlob = ExcelGenerator.generateExcel(this.currentQuote);
        
        // Create filename
        const firstShipTo = this.currentQuote.items[0].shipTo || 'Quote';
        const date = new Date(this.currentQuote.dateCreated).toLocaleDateString('en-GB').replace(/\//g, '-');
        const filename = `Quote_${firstShipTo}_${date}.xlsx`;
        
        // Convert blob to base64 for mailto (note: this has limitations)
        this.showAlert('üìß Email client opened! Please attach the downloaded Excel file and send.', 'info');
        
        // Download the file first
        this.downloadExcelFileWithName(excelBlob, filename);
        
        // Open mailto
        const subject = `New Quote Request - ${this.currentQuote.id}`;
        const body = `Dear Sales Manager,

New quote request has been created.

Quote ID: ${this.currentQuote.id}
Date: ${new Date(this.currentQuote.dateCreated).toLocaleDateString()}
Total Items: ${this.currentQuote.summary.totalItems}
Total Units: ${this.currentQuote.summary.totalUnits.toLocaleString()}
Total Boxes: ${this.currentQuote.summary.totalBoxes}
Total Weight: ${this.currentQuote.summary.totalWeight.toFixed(2)} kg

Please find the Excel file (${filename}) that was just downloaded.
Attach it to this email before sending.

Best regards`;
        
        const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        window.location.href = mailtoLink;
        
        this.closeEmailModal();
    },
    
    async downloadExcelFile() {
        try {
            // Show loading indicator
            const btn = document.querySelector('button[onclick*="downloadExcelFile"]');
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = '‚è≥ Generating...';
            }
            
            const excelBlob = await ExcelGenerator.generateExcel(this.currentQuote);
            const firstShipTo = this.currentQuote.items[0].shipTo || 'Quote';
            const date = new Date(this.currentQuote.dateCreated).toLocaleDateString('en-GB').replace(/\//g, '-');
            const filename = `Quote_${firstShipTo}_${date}.xlsx`;
            
            this.downloadExcelFileWithName(excelBlob, filename);
            this.showAlert('Excel file downloaded successfully!', 'success');
            
            // Reset button
            if (btn) {
                btn.disabled = false;
                btn.innerHTML = 'üíæ Download Excel';
            }
            
            // Don't close modal - keep the quote visible
        } catch (error) {
            console.error('Download error:', error);
            this.showAlert('Failed to download Excel: ' + error.message, 'error');
        }
    },
    
    downloadExcelFileWithName(blob, filename) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    },
    
    async downloadPDFFile() {
        try {
            // Show loading indicator
            const btn = document.querySelector('button[onclick*="downloadPDFFile"]') || 
                        document.querySelector('button[onclick*="downloadQuotePDF"]');
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = '‚è≥ Generating...';
            }
            
            // Generate PDF from currentQuote
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Header
            doc.setFontSize(18);
            doc.text('Metal Hook Quote', 105, 20, { align: 'center' });
            
            doc.setFontSize(10);
            doc.text(`Quote ID: ${this.currentQuote.id}`, 20, 35);
            doc.text(`Date: ${new Date(this.currentQuote.dateCreated).toLocaleDateString('en-GB')}`, 20, 42);
            doc.text(`Status: ${this.currentQuote.status}`, 20, 49);
            
            // Table headers
            let yPos = 60;
            doc.setFontSize(9);
            const headers = ['#', 'Ship To', 'Hook Type', 'Size', 'Twine', 'Total (m)', 'Units', 'Boxes', 'PN'];
            const colWidths = [10, 25, 20, 15, 15, 18, 15, 15, 35];
            let xPos = 15;
            
            headers.forEach((header, i) => {
                doc.text(header, xPos, yPos);
                xPos += colWidths[i];
            });
            
            // Table rows
            yPos += 7;
            this.currentQuote.items.forEach((item, idx) => {
                xPos = 15;
                const displaySize = item.hookSize === '180' ? '18' : item.hookSize === '220' ? '22' : String(item.hookSize || '-');
                const rowData = [
                    String(idx + 1),
                    item.shipTo || '-',
                    item.hookType || '-',
                    displaySize,
                    item.twineType || '-',
                    item.totalLength ? item.totalLength.toFixed(1) : '-',
                    String(item.units || '-'),
                    String(item.boxes || '-'),
                    item.pn || '-'
                ];
                
                rowData.forEach((data, i) => {
                    doc.text(data, xPos, yPos);
                    xPos += colWidths[i];
                });
                
                yPos += 7;
                
                // New page if needed
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }
            });
            
            // Summary
            yPos += 10;
            if (yPos > 250) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(12);
            doc.text('Summary', 20, yPos);
            yPos += 10;
            
            doc.setFontSize(10);
            doc.text(`Total Items: ${this.currentQuote.summary.totalItems}`, 20, yPos);
            yPos += 7;
            doc.text(`Total Units: ${this.currentQuote.summary.totalUnits}`, 20, yPos);
            yPos += 7;
            doc.text(`Total Boxes: ${this.currentQuote.summary.totalBoxes}`, 20, yPos);
            
            // Download
            const firstShipTo = this.currentQuote.items[0].shipTo || 'Quote';
            const date = new Date(this.currentQuote.dateCreated).toLocaleDateString('en-GB').replace(/\//g, '-');
            const filename = `Quote_${firstShipTo}_${date}.pdf`;
            
            doc.save(filename);
            this.showAlert('PDF file downloaded successfully!', 'success');
            
            // Reset button - find it more reliably
            if (btn) {
                btn.disabled = false;
                btn.innerHTML = 'üìÑ Download PDF';
            }
            
        } catch (error) {
            console.error('PDF download error:', error);
            this.showAlert('Failed to download PDF: ' + error.message, 'error');
            
            // Reset button on error too
            const btn = document.querySelector('button[onclick*="downloadPDFFile"]') || 
                        document.querySelector('button[onclick*="downloadQuotePDF"]');
            if (btn) {
                btn.disabled = false;
                btn.innerHTML = 'üìÑ Download PDF';
            }
        }
    },
    
    handleColorSelection(id, color) {
        // Handle single color selection from dropdown
        if (!color) return;
        
        const item = QuoteData.getItem(id);
        if (!item) return;
        
        // Set single color
        item.colors = [{ color: color, quantity: item.unitsPerBox || 0 }];
        item.colorUIMode = 'single';  // Ensure stays in single mode
        
        QuoteData.save();
        this.render();
        this.updateSummary();
    },
    
    toggleColorUI(id, mode) {
        // Toggle between single and sequence UI modes
        const item = QuoteData.getItem(id);
        if (!item) return;
        
        item.colorUIMode = mode;
        
        // If switching to single and has sequence colors, clear them
        if (mode === 'single' && item.colors.length > 1) {
            item.colors = [];
        }
        
        QuoteData.save();
        this.render();
    },
    
    openColorsModal(id, mode) {
        this.currentColorsRow = id;
        this.currentColorsMode = mode;
        const item = QuoteData.getItem(id);
        const modal = document.getElementById('colorsModal');
        const body = document.getElementById('colorsModalBody');
        
        // Determine available colors based on twine type
        const isBio = item.twineType === 'Bio250' || item.twineType === 'Bio390';
        const availableColors = isBio 
            ? CONFIG.COLORS.filter(c => c !== 'Mixed')
            : CONFIG.COLORS.filter(c => c !== 'Mixed' && c !== 'Red');
        
        let html = '';
        
        if (mode === 'single') {
            const currentColor = item.colors.length > 0 ? item.colors[0].color : '';
            
            html += '<div style="margin-bottom: 20px;">';
            html += '<p style="color: #666; margin-bottom: 15px;">Select a single wire color for all hooks:</p>';
            html += `
                <select id="singleColorSelect" class="cell-select" style="font-size: 1rem; padding: 12px;">
                    <option value="">Choose your color</option>
                    ${availableColors.map(col => `<option value="${col}" ${col === currentColor ? 'selected' : ''}>${col}</option>`).join('')}
                </select>
            `;
            html += '</div>';
            
            html += '<div style="display: flex; gap: 10px;">';
            html += '<button class="btn btn-primary" onclick="QuoteUI.saveSingleColor()" style="width: 60%; margin: 0 auto; display: block;">‚úì Save Color</button>';
            html += '<button class="btn btn-secondary" onclick="QuoteUI.closeColorsModal()" style="flex: 1;">Cancel</button>';
            html += '</div>';
            
        } else {
            const currentColors = item.colors.length >= 2 ? item.colors : [
                { color: '', quantity: 1 },
                { color: '', quantity: 1 }
            ];
            
            html += '<div id="modalAlertBox" class="alert" style="display: none; margin-bottom: 15px;"></div>';
            html += '<div style="margin-bottom: 20px;">';
            html += '<p style="color: #666; margin-bottom: 10px;"><strong>Create a color sequence (2-10 colors required)</strong></p>';
            html += '<p style="color: #999; font-size: 0.85rem; margin-bottom: 15px;">Example: Red √ó2, Blue √ó3, Yellow √ó1 (repeating pattern)</p>';
            
            html += '<div id="colorsSequence">';
            currentColors.forEach((c, idx) => {
                html += `
                    <div class="color-row" data-idx="${idx}" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                        <span style="min-width: 30px; color: #666; font-weight: 600;">${idx + 1}.</span>
                        <select class="cell-select color-select" style="flex: 2;" data-idx="${idx}">
                            <option value="">Choose your color</option>
                            ${availableColors.map(col => `<option value="${col}" ${c.color === col ? 'selected' : ''}>${col}</option>`).join('')}
                        </select>
                        <input type="number" class="cell-input color-qty" style="flex: 1;" min="1" value="${c.quantity}" data-idx="${idx}" placeholder="Qty">
                        <button class="btn btn-secondary" onclick="QuoteUI.removeColorRow(this)" style="padding: 8px 12px;" ${currentColors.length <= 2 ? 'disabled' : ''}>üóëÔ∏è</button>
                    </div>
                `;
            });
            html += '</div>';
            
            const canAddMore = currentColors.length < 10;
            html += `<button class="btn btn-success" onclick="QuoteUI.addColorRow()" style="width: 60%; margin: 0 auto; display: block;" ${!canAddMore ? 'disabled' : ''}>
                ‚ûï Add Color ${canAddMore ? `(${currentColors.length}/10)` : '(Max 10)'}
            </button>`;
            html += '</div>';
            
            html += '<div style="display: flex; gap: 10px; margin-top: 20px;">';
            html += '<button class="btn btn-primary" onclick="QuoteUI.saveSequenceColors()" style="width: 60%; margin: 0 auto; display: block;">‚úì Save Sequence</button>';
            html += '<button class="btn btn-secondary" onclick="QuoteUI.closeColorsModal()" style="flex: 1;">Cancel</button>';
            html += '</div>';
        }
        
        body.innerHTML = html;
        modal.classList.add('show');
    },
    
    closeColorsModal() {
        document.getElementById('colorsModal').classList.remove('show');
        this.currentColorsRow = null;
        this.currentColorsMode = null;
    },
    
    saveSingleColor() {
        const select = document.getElementById('singleColorSelect');
        const color = select.value;
        
        if (!color) {
            this.showAlert('Please select a color', 'warning');
            return;
        }
        
        const item = QuoteData.getItem(this.currentColorsRow);
        if (item) {
            item.colors = [{ color, quantity: 1 }];
            QuoteData.calculate(this.currentColorsRow);
            QuoteData.save();
            this.render();
            this.updateSummary();
            this.closeColorsModal();
            this.showAlert(`‚úì Color saved: ${color}`, 'success');
        }
    },
    
    saveSequenceColors() {
        const selects = document.querySelectorAll('#colorsSequence .color-select');
        const inputs = document.querySelectorAll('#colorsSequence .color-qty');
        
        const colors = [];
        selects.forEach((sel, idx) => {
            const color = sel.value;
            const qty = parseInt(inputs[idx].value) || 1;
            if (color) {
                colors.push({ color, quantity: qty });
            }
        });
        
        if (colors.length < 2) {
            const modalAlert = document.getElementById('modalAlertBox');
            if (modalAlert) {
                modalAlert.className = 'alert alert-warning';
                modalAlert.style.display = 'block';
                modalAlert.innerHTML = `
                    <span>Sequence mode requires at least 2 colors. Please add more colors or use single color mode.</span>
                    <button onclick="this.parentElement.style.display='none'" 
                            style="margin-left: 15px; padding: 5px 12px; background: rgba(255,255,255,0.3); border: none; border-radius: 4px; cursor: pointer; color: inherit; font-weight: 600;">‚úï</button>
                `;
            }
            return;
        }
        
        if (colors.length > 10) {
            const modalAlert = document.getElementById('modalAlertBox');
            if (modalAlert) {
                modalAlert.className = 'alert alert-warning';
                modalAlert.style.display = 'block';
                modalAlert.innerHTML = `
                    <span>Maximum 10 colors allowed</span>
                    <button onclick="this.parentElement.style.display='none'" 
                            style="margin-left: 15px; padding: 5px 12px; background: rgba(255,255,255,0.3); border: none; border-radius: 4px; cursor: pointer; color: inherit; font-weight: 600;">‚úï</button>
                `;
            }
            return;
        }
        
        const item = QuoteData.getItem(this.currentColorsRow);
        if (item) {
            item.colors = colors;
            item.colorUIMode = 'sequence';  // Stay in sequence mode
            QuoteData.calculate(this.currentColorsRow);
            QuoteData.save();
            this.render();
            this.updateSummary();
            this.closeColorsModal();
            this.showAlert(`‚úì Color sequence saved (${colors.length} colors)`, 'success');
        }
    },
    
    addColorRow() {
        const container = document.getElementById('colorsSequence');
        const currentCount = container.children.length;
        
        if (currentCount >= 10) {
            this.showAlert('Maximum 10 colors allowed', 'warning');
            return;
        }
        
        const idx = currentCount;
        const item = QuoteData.getItem(this.currentColorsRow);
        const isBio = item.twineType === 'Bio250' || item.twineType === 'Bio390';
        const availableColors = isBio 
            ? CONFIG.COLORS.filter(c => c !== 'Mixed')
            : CONFIG.COLORS.filter(c => c !== 'Mixed' && c !== 'Red');
        
        const newRow = document.createElement('div');
        newRow.className = 'color-row';
        newRow.setAttribute('data-idx', idx);
        newRow.style.cssText = 'display: flex; gap: 10px; margin-bottom: 10px; align-items: center;';
        newRow.innerHTML = `
            <span style="min-width: 30px; color: #666; font-weight: 600;">${idx + 1}.</span>
            <select class="cell-select color-select" style="flex: 2;" data-idx="${idx}">
                <option value="">Choose your color</option>
                ${availableColors.map(col => `<option value="${col}">${col}</option>`).join('')}
            </select>
            <input type="number" class="cell-input color-qty" style="flex: 1;" min="1" value="1" data-idx="${idx}" placeholder="Qty">
            <button class="btn btn-secondary" onclick="QuoteUI.removeColorRow(this)" style="padding: 8px 12px;">üóëÔ∏è</button>
        `;
        
        container.appendChild(newRow);
        
        const addBtn = container.parentElement.querySelector('.btn-success');
        if (addBtn && currentCount + 1 >= 10) {
            addBtn.disabled = true;
            addBtn.innerHTML = '‚ûï Add Color (Max 10)';
        } else if (addBtn) {
            addBtn.innerHTML = `‚ûï Add Color (${currentCount + 1}/10)`;
        }
        
        Array.from(container.children).forEach(row => {
            const deleteBtn = row.querySelector('.btn-secondary');
            if (deleteBtn) deleteBtn.disabled = false;
        });
    },
    
    removeColorRow(btn) {
        const container = document.getElementById('colorsSequence');
        if (container.children.length <= 2) {
            this.showAlert('At least 2 colors are required for sequence mode', 'warning');
            return;
        }
        
        btn.closest('.color-row').remove();
        
        Array.from(container.children).forEach((row, idx) => {
            row.querySelector('span').textContent = `${idx + 1}.`;
            const deleteBtn = row.querySelector('.btn-secondary');
            deleteBtn.disabled = container.children.length <= 2;
        });
        
        const addBtn = container.parentElement.querySelector('.btn-success');
        if (addBtn) {
            const count = container.children.length;
            addBtn.disabled = false;
            addBtn.innerHTML = `‚ûï Add Color (${count}/10)`;
        }
    },
    
    handleQuantityInput(id, input) {
        // Remove all non-numeric characters except comma
        let value = input.value.replace(/[^0-9,]/g, '');
        input.value = value;
        
        // Remove commas for calculation
        value = value.replace(/,/g, '');
        if (value && !isNaN(value)) {
            const numValue = parseInt(value);
            input.value = numValue.toLocaleString();
            // Save the value for calculation display
            QuoteData.updateItem(id, 'quantity', numValue);
            QuoteData.calculate(id);
            // Update summary in real-time
            this.updateSummary();
        }
    },
    
    handleQuantityChange(id, value) {
        const cleanValue = value.replace(/,/g, '');
        const quantity = parseInt(cleanValue) || 0;
        
        if (quantity === 0) {
            QuoteData.updateItem(id, 'quantity', '');
            return;
        }
        
        const item = QuoteData.getItem(id);
        
        if (!item.hookSize || !item.twineType || !item.hookType || !item.totalLength) {
            this.showAlert('Please fill in Hook Type, Hook Size, Twine Type, and Wire/FF fields first', 'warning');
            return;
        }
        
        const hookCode = item.hookSize === '180' ? '518' : '522';
        const totalWire = QuoteData.smartRoundTotalLength(item.totalLength);
        const dbTwineType = QuoteData.mapTwineTypeToDBKey(item.twineType);
        const key = `${hookCode}-${dbTwineType}-${totalWire}-${item.hookType}`;
        const cartonData = CARTON_DB[key];
        
        if (!cartonData) {
            this.showAlert('Configuration not found in database. Please check your selections.', 'error');
            return;
        }
        
        const unitsPerCarton = cartonData.unitsPerCarton;
        const remainder = quantity % unitsPerCarton;
        
        if (remainder !== 0) {
            const cartonsNeeded = Math.ceil(quantity / unitsPerCarton);
            const roundedQty = cartonsNeeded * unitsPerCarton;
            const difference = roundedQty - quantity;
            
            this.showRoundingModal(id, quantity, unitsPerCarton, cartonsNeeded, roundedQty, difference);
        } else {
            QuoteData.updateItem(id, 'quantity', quantity);
            this.updateSummary();
        }
    },
    
    // ============================================
    // CRITICAL: ROUNDING MODAL FUNCTIONS
    // DO NOT DELETE - Essential for system!
    // These functions handle partial carton warnings
    // ============================================
    
    showRoundingModal(id, originalQty, unitsPerCarton, cartons, roundedQty, difference) {
        const modal = document.getElementById('roundingModal');
        const body = document.getElementById('roundingModalBody');
        
        body.innerHTML = `
            <h3 style="margin-bottom: 20px;">‚ö†Ô∏è Partial Box Detected</h3>
            
            <div style="background: #f3f4f6; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p style="margin: 5px 0;"><strong>You entered:</strong> ${originalQty.toLocaleString()} units</p>
                <p style="margin: 5px 0;"><strong>Units per box:</strong> ${unitsPerCarton}</p>
                <p style="margin: 5px 0;"><strong>This equals:</strong> ${(originalQty / unitsPerCarton).toFixed(2)} boxes</p>
            </div>
            
            <p style="color: #dc2626; font-size: 1rem; margin-bottom: 20px; font-weight: 600; background: #fee2e2; padding: 15px; border-radius: 8px; border-left: 4px solid #dc2626;">
                ‚ö†Ô∏è We cannot ship partial boxes. Your quantity will be automatically rounded up to full boxes.
            </p>
            
            <div style="background: #dcfce7; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #16a34a;">
                <p style="margin: 5px 0;"><strong>${cartons} boxes</strong> = ${roundedQty.toLocaleString()} units</p>
                <p style="margin: 5px 0; color: #16a34a;">(+${difference} units)</p>
            </div>
            
            <button class="btn btn-primary" onclick="QuoteUI.applyRounding(${id}, ${roundedQty})" style="width: 60%; margin: 0 auto; display: block;">
                ‚úì Round Up to ${roundedQty.toLocaleString()} units
            </button>
        `;
        
        modal.classList.add('show');
    },
    
    applyRounding(id, roundedQty) {
        QuoteData.updateItem(id, 'quantity', roundedQty);
        document.getElementById('roundingModal').classList.remove('show');
        this.render();
        this.updateSummary();
        this.showAlert(`‚úì Quantity rounded to ${roundedQty.toLocaleString()} units`, 'success');
    },
    
    render() {
        const container = document.getElementById('tableContainer');
        
        if (QuoteData.items.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <h3>No items yet</h3>
                    <p>Click "+ Add Item" to start adding items to your quote</p>
                </div>
            `;
            return;
        }
        
        let html = '';
        
        // Add sticky banner in selection mode
        if (this.selectionMode && !this.bannerDismissed) {
            html += `
                <div class="selection-banner" id="selectionBanner">
                    <div class="selection-banner-content">
                        <div class="selection-banner-icon">‚ÑπÔ∏è</div>
                        <div class="selection-banner-text">
                            Select rows using checkboxes, then click "Duplicate X Rows" button
                        </div>
                    </div>
                    <button class="selection-banner-close" onclick="QuoteUI.dismissBanner()" title="Close">
                        ‚úï
                    </button>
                </div>
            `;
        }
        
        html += `
            <table class="quote-table">
                <thead>
                    <tr>
                        ${this.selectionMode ? `
                        <th style="min-width: 50px; text-align: center;">
                            <input type="checkbox" 
                                   id="selectAllCheckbox"
                                   onchange="QuoteUI.toggleSelectAll(this.checked)"
                                   style="width: 18px; height: 18px; cursor: pointer;"
                                   title="Select All">
                        </th>
                        ` : ''}
                        <th style="min-width: 40px;">#</th>
                        <th style="min-width: 100px;">Grower<br><span style="font-weight: normal; font-size: 0.75rem;">(Optional)</span></th>
                        <th style="min-width: 120px;">Ship To *</th>
                        <th style="min-width: 160px;">
                            Req. Delivery Date *<br>
                            <select id="dateFormatSelector" onchange="QuoteUI.changeDateFormat(this.value)" 
                                    style="font-size: 0.75rem; padding: 4px 8px; margin-top: 4px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.9); cursor: pointer;">
                                <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                            </select>
                        </th>
                        <th style="min-width: 110px;">Hook Type *</th>
                        <th style="min-width: 110px;">Hook Size *</th>
                        <th style="min-width: 100px;">Crop *</th>
                        <th style="min-width: 120px;">Twine Type *</th>
                        <th style="min-width: 170px;">Twine Color *</th>
                        <th style="min-width: 120px;">Twine on Hook (m) *</th>
                        <th style="min-width: 110px;">Free Fall (m) *</th>
                        <th style="min-width: 100px;">Total Twine</th>
                        <th style="min-width: 120px;">Units *</th>
                        <th style="min-width: 80px;">Units/Box</th>
                        <th style="min-width: 70px;">Boxes</th>
                        <th style="min-width: 160px;">PN (product number)</th>
                        <th style="min-width: 100px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        QuoteData.items.forEach((item, index) => {
            const colorsText = item.colors.length > 0 
                ? (item.colors.length === 1 
                    ? item.colors[0].color  // ◊¶◊ë◊¢ ◊ë◊ï◊ì◊ì - ◊®◊ß ◊©◊ù ◊î◊¶◊ë◊¢
                    : item.colors.map(c => `${c.color}√ó${c.quantity}`).join(', '))  // sequence - ◊¢◊ù ◊õ◊û◊ï◊ô◊ï◊™
                : 'Not set';
            
            html += `
                <tr data-item-id="${item.id}" ${this.selectedRows.has(item.id) ? 'class="duplicate-preview"' : ''}>
                    ${this.selectionMode ? `
                    <td style="text-align: center; background: ${this.selectedRows.has(item.id) ? 'transparent' : 'white'};">
                        <input type="checkbox" 
                               ${this.selectedRows.has(item.id) ? 'checked' : ''}
                               onchange="QuoteUI.toggleRowSelection(${item.id}, this.checked)"
                               style="width: 18px; height: 18px; cursor: pointer;">
                    </td>
                    ` : ''}
                    <td class="row-number">${index + 1}</td>
                    
                    <td>
                        <input type="text" class="cell-input" 
                               value="${item.grower}" 
                               onchange="QuoteData.updateItem(${item.id}, 'grower', this.value); QuoteUI.updateSummary();"
                               onblur="this.value = QuoteData.getItem(${item.id}).grower;">
                    </td>
                    
                    <td>
                        <select class="cell-select" 
                                onchange="QuoteData.updateItem(${item.id}, 'shipTo', this.value); QuoteUI.updateSummary();">
                            <option value="">Select...</option>
                            ${CONFIG.COUNTRIES.map(c => `<option value="${c}" ${item.shipTo === c ? 'selected' : ''}>${c}</option>`).join('')}
                        </select>
                    </td>
                    
                    <td>
                        <div style="position: relative;">
                            <input type="text" 
                                   class="cell-input date-display-input" 
                                   data-item-id="${item.id}"
                                   value="${QuoteUI.formatDateForDisplay(item.reqDate)}" 
                                   placeholder="üìÖ ${localStorage.getItem('preferredDateFormat') || 'DD/MM/YYYY'}"
                                   readonly
                                   onclick="document.getElementById('datePicker_${item.id}').showPicker();"
                                   style="cursor: pointer; background: white;">
                            <input type="date" 
                                   id="datePicker_${item.id}"
                                   style="position: absolute; opacity: 0; pointer-events: none; width: 0; height: 0;"
                                   value="${item.reqDate}" 
                                   min="${(() => { const d = new Date(); d.setDate(d.getDate() + 1); return d.toISOString().split('T')[0]; })()}"
                                   onchange="QuoteUI.handleDateChange(${item.id}, this.value);">
                        </div>
                    </td>
                    
                    <td>
                        <select class="cell-select" 
                                onchange="QuoteData.updateItem(${item.id}, 'hookType', this.value); 
                                          if (this.value === 'No Free Fall') {
                                              QuoteData.updateItem(${item.id}, 'freeFallLength', '0');
                                          }
                                          QuoteUI.render(); QuoteUI.updateSummary();">
                            <option value="">Select...</option>
                            ${CONFIG.HOOK_TYPES.map(t => `<option value="${t}" ${item.hookType === t ? 'selected' : ''}>${t}</option>`).join('')}
                        </select>
                    </td>
                    
                    <td>
                        <select class="cell-select" 
                                onchange="QuoteData.updateItem(${item.id}, 'hookSize', this.value); QuoteUI.render(); QuoteUI.updateSummary();">
                            <option value="">Select...</option>
                            ${CONFIG.HOOK_SIZES.map(s => `<option value="${s}" ${item.hookSize === s ? 'selected' : ''}>${s}mm</option>`).join('')}
                        </select>
                    </td>
                    
                    <td>
                        <select class="cell-select" 
                                onchange="QuoteData.updateItem(${item.id}, 'crop', this.value); QuoteUI.updateSummary();">
                            <option value="">Select...</option>
                            ${CONFIG.CROPS.map(c => `<option value="${c}" ${item.crop === c ? 'selected' : ''}>${c}</option>`).join('')}
                        </select>
                    </td>
                    
                    <td>
                        <select class="cell-select" 
                                onchange="QuoteData.updateItem(${item.id}, 'twineType', this.value); 
                                          
                                          // Dismiss any alert (especially Wire Length warning)
                                          const alertBox = document.getElementById('alertBox');
                                          if (alertBox && alertBox.classList.contains('show')) {
                                              alertBox.classList.remove('show');
                                          }
                                          
                                          if (this.value === 'Bio250' || this.value === 'Bio390') {
                                              const item = QuoteData.getItem(${item.id});
                                              if (item.colors.length > 1) {
                                                  item.colors = [];
                                                  QuoteData.save();
                                                  QuoteUI.showAlert('Color sequence not available for Bio twines. Please select single color.', 'warning');
                                              }
                                          }
                                          QuoteUI.render(); QuoteUI.updateSummary();">
                            <option value="">Select...</option>
                            ${CONFIG.TWINE_TYPES.map(t => `<option value="${t}" ${item.twineType === t ? 'selected' : ''}>${t}</option>`).join('')}
                        </select>
                    </td>
                    
                    <td>
                        ${(() => {
                            const isBio = item.twineType === 'Bio250' || item.twineType === 'Bio390';
                            const uiMode = item.colorUIMode || 'single';
                            
                            // Get available colors
                            let availableColors = CONFIG.COLORS.filter(c => c !== 'Mixed');
                            if (!isBio) {
                                availableColors = availableColors.filter(c => c !== 'Red');
                            }
                            
                            // Generate options HTML
                            const colorOptions = availableColors.map(color => {
                                const selected = item.colors.length === 1 && item.colors[0].color === color ? 'selected' : '';
                                return '<option value="' + color + '" ' + selected + '>' + color + '</option>';
                            }).join('');
                            
                            // BIO: always single color only
                            if (isBio) {
                                return '<select class="cell-select color-select-field" onchange="QuoteUI.handleColorSelection(' + item.id + ', this.value)">' +
                                       '<option value="">Select color...</option>' +
                                       colorOptions +
                                       '</select>' +
                                       '<div style="font-size: 0.8rem; text-align: center; margin-top: 8px; padding: 6px; background: #fef3c7; color: #92400e; border-radius: 4px;">' +
                                       '‚ÑπÔ∏è Bio twines support single color only' +
                                       '</div>' +
                                       '<div style="font-size: 0.8rem; text-align: center; margin-top: 6px; color: #666; font-weight: 600;">' +
                                       colorsText +
                                       '</div>';
                            }
                            
                            // Non-BIO: toggle between single and sequence
                            if (uiMode === 'single') {
                                return '<select class="cell-select color-select-field" onchange="QuoteUI.handleColorSelection(' + item.id + ', this.value)">' +
                                       '<option value="">Select color...</option>' +
                                       colorOptions +
                                       '</select>' +
                                       '<div style="font-size: 0.85rem; text-align: center; margin-top: 8px; color: #444; line-height: 1.4;">' +
                                       'For special request for color sequence in a box ' +
                                       '<a href="#" onclick="event.preventDefault(); QuoteUI.toggleColorUI(' + item.id + ', \'sequence\');" style="color: #00AFE6; text-decoration: none; font-weight: 600;">click here</a>' +
                                       '</div>' +
                                       '<div style="font-size: 0.8rem; text-align: center; margin-top: 6px; color: #666; font-weight: 600;">' +
                                       colorsText +
                                       '</div>';
                            } else {
                                return '<button type="button" onclick="QuoteUI.openColorsModal(' + item.id + ', \'sequence\')" style="width: 100%; padding: 8px 12px; background: linear-gradient(135deg, #00AFE6 0%, #0099CC 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;" onmouseover="this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 8px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 4px rgba(0,0,0,0.1)\';">' +
                                       'üé® Color Sequence' +
                                       '</button>' +
                                       '<div style="font-size: 0.85rem; text-align: center; margin-top: 8px; color: #444; line-height: 1.4;">' +
                                       'or <a href="#" onclick="event.preventDefault(); QuoteUI.toggleColorUI(' + item.id + ', \'single\');" style="color: #00AFE6; text-decoration: none; font-weight: 600;">single color</a>' +
                                       '</div>' +
                                       '<div style="font-size: 0.8rem; text-align: center; margin-top: 6px; color: #666; font-weight: 600;">' +
                                       colorsText +
                                       '</div>';
                            }
                        })()}
                    </td>
                    
                    <td>
                        <input type="text" class="cell-input wire-input ${(() => {
                                   if (!item.twineType || !item.wireLength) return '';
                                   const ranges = {'1000':{min:3,max:25},'1200':{min:2.5,max:38},'1300':{min:6,max:38},'1500':{min:5,max:38},'Bio250':{min:6,max:38},'Bio390':{min:2.5,max:37.5}};
                                   const range = ranges[item.twineType];
                                   if (!range) return '';
                                   const val = parseFloat(item.wireLength);
                                   if (isNaN(val)) return '';
                                   return (val >= range.min && val <= range.max) ? '' : 'input-invalid';
                               })()}" 
                               value="${item.wireLength}" 
                               data-item-id="${item.id}"
                               oninput="
                                   const item = QuoteData.getItem(${item.id});
                                   if (!item.twineType && this.value) {
                                       this.value = '';
                                       QuoteUI.showAlert('‚ö†Ô∏è Please select Twine Type first before entering Twine on Hook', 'warning');
                                       return;
                                   }
                                   this.value = this.value.replace(/[^0-9.]/g, ''); 
                                   QuoteData.updateItem(${item.id}, 'wireLength', this.value);
                               "
                               onclick="
                                   const item = QuoteData.getItem(${item.id});
                                   if (!item.twineType) {
                                       QuoteUI.showAlert('‚ö†Ô∏è Please select Twine Type first', 'warning');
                                   }
                               "
                               onblur="QuoteUI.updateTotalTwine(${item.id}); QuoteUI.render(); QuoteUI.updateSummary();"
                               placeholder="${(() => {
                                   const ranges = {
                                       '1000': '3-25',
                                       '1200': '2.5-38',
                                       '1300': '6-38',
                                       '1500': '5-38',
                                       'Bio250': '6-38',
                                       'Bio390': '2.5-37.5'
                                   };
                                   return ranges[item.twineType] || '2.5-38';
                               })()}">
                    </td>
                    
                    <td>
                        <input type="text" class="cell-input ff-input ${(() => {
                                   if (!item.freeFallLength && item.freeFallLength !== 0) return '';
                                   const val = parseFloat(item.freeFallLength);
                                   if (isNaN(val)) return '';
                                   return (val >= 0 && val <= 10) ? '' : 'input-invalid';
                               })()}" 
                               value="${item.hookType === 'No Free Fall' ? '0' : item.freeFallLength}" 
                               data-item-id="${item.id}"
                               ${item.hookType === 'No Free Fall' ? 'disabled readonly style="background-color: #f5f5f5; cursor: not-allowed;"' : ''}
                               oninput="this.value = this.value.replace(/[^0-9.]/g, ''); QuoteData.updateItem(${item.id}, 'freeFallLength', this.value);"
                               onblur="QuoteUI.updateTotalTwine(${item.id}); QuoteUI.render(); QuoteUI.updateSummary();"
                               placeholder="0-10">
                    </td>
                    
                    <td>
                        <input type="text" 
                               class="cell-input" 
                               value="${item.totalLength ? item.totalLength.toFixed(1) + 'm' : '0.0m'}" 
                               readonly
                               disabled
                               style="background: #f0fdf4; font-weight: 600; text-align: center; cursor: not-allowed;">
                        ${(() => {
                            if (!item.twineType) return '';
                            const ranges = {'1000':{min:3,max:25},'1200':{min:2.5,max:38},'1300':{min:6,max:38},'1500':{min:5,max:38},'Bio250':{min:6,max:38},'Bio390':{min:2.5,max:37.5}};
                            const range = ranges[item.twineType];
                            if (!range) return '';
                            
                            const wire = parseFloat(item.wireLength) || 0;
                            const ff = parseFloat(item.freeFallLength) || 0;
                            const total = wire + ff;
                            const isValid = wire >= range.min && wire <= range.max && ff >= 0 && ff <= 10;
                            
                            // Red warning - if out of range
                            if (!isValid && (wire > 0 || ff > 0)) {
                                return `<div style="font-size: 0.75rem; padding: 4px 6px; background: #fee2e2; color: #991b1b; border-radius: 4px; margin-top: 3px; text-align: center; font-weight: 600;">
                                    ‚ö†Ô∏è Must be ${range.min}-${range.max}m
                                </div>`;
                            }
                            
                            // Yellow info box - only if valid or no input yet
                            return `<div style="font-size: 0.75rem; padding: 4px 6px; background: #fef3c7; color: #92400e; border-radius: 4px; margin-top: 3px; text-align: center;">
                                ‚ÑπÔ∏è Range: ${range.min}-${range.max}m
                            </div>`;
                        })()}
                    </td>
                    
                    <td>
                        <input type="text" class="cell-input" 
                               value="${item.quantity ? parseInt(item.quantity).toLocaleString() : ''}" 
                               oninput="QuoteUI.handleQuantityInput(${item.id}, this);"
                               onchange="QuoteUI.handleQuantityChange(${item.id}, this.value); QuoteUI.render();"
                               placeholder="e.g. 60,000">
                    </td>
                    
                    <td>
                        <input type="text" 
                               class="cell-input" 
                               value="${item.unitsPerBox || '-'}" 
                               readonly
                               disabled
                               style="background: #f0fdf4; font-weight: 600; text-align: center; cursor: not-allowed;">
                    </td>
                    <td>
                        <input type="text" 
                               class="cell-input" 
                               value="${item.actualBoxes || 0}" 
                               readonly
                               disabled
                               style="background: #f0fdf4; font-weight: 600; text-align: center; cursor: not-allowed;">
                    </td>
                    <td>
                        <input type="text" 
                               class="cell-input" 
                               value="${item.pn || ''}" 
                               readonly
                               disabled
                               style="background: #f0fdf4; font-size: 0.75rem; text-align: center; cursor: not-allowed; font-family: monospace;">
                    </td>
                    
                    <td>
                        <div class="row-actions">
                            <button class="row-action-btn" onclick="QuoteUI.deleteRow(${item.id})" title="Delete">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `;
        });
        
        html += '</tbody></table>';
        
        container.innerHTML = html;
        
        // Update date format selector to match saved preference
        setTimeout(() => {
            const savedFormat = localStorage.getItem('preferredDateFormat') || 'DD/MM/YYYY';
            const selector = document.getElementById('dateFormatSelector');
            if (selector && selector.value !== savedFormat) {
                selector.value = savedFormat;
            }
            
            // Update all date input fields with correct format
            const dateInputs = document.querySelectorAll('.date-input');
            dateInputs.forEach(input => {
                const dateStr = input.getAttribute('data-date');
                if (dateStr) {
                    input.value = this.formatDateForDisplay(dateStr);
                    input.placeholder = savedFormat;
                }
            });
        }, 0);
        
        // Force recalculation of all items
        QuoteData.items.forEach(item => {
            // Always recalculate total length
            const wire = parseFloat(item.wireLength) || 0;
            const ff = parseFloat(item.freeFallLength);
            
            if (ff !== undefined && ff !== null && ff !== '') {
                item.totalLength = wire + parseFloat(ff);
            } else if (item.wireLength) {
                item.totalLength = wire;
            }
            
            // Always try to calculate if we have the minimum required fields
            if (item.hookSize && item.twineType && item.hookType) {
                QuoteData.calculate(item.id);
            }
        });
        
        // Save after recalculation
        QuoteData.save();
        
        // Update button text based on editing mode
        setTimeout(() => {
            const btn = document.getElementById('generateQuoteBtn');
            if (btn) {
                if (this.editingQuoteId) {
                    btn.innerHTML = '‚úèÔ∏è Update Quote';
                } else {
                    btn.innerHTML = 'üéØ Generate Quote';
                }
            }
        }, 10);
    },
    
    showAlert(message, type, persist = null) {
        const alert = document.getElementById('alertBox');
        alert.className = `alert alert-${type} show`;
        
        // Determine if alert should persist
        // If persist is explicitly false, auto-hide even for errors/warnings
        // If persist is true, always persist
        // If persist is null (default), warnings/errors persist, success auto-hides
        const shouldPersist = persist === true || (persist === null && (type === 'error' || type === 'warning'));
        
        if (shouldPersist) {
            // Add close button for persistent alerts
            alert.innerHTML = `
                <span>${message}</span>
                <button onclick="this.parentElement.classList.remove('show')" 
                        style="margin-left: 15px; padding: 5px 12px; background: rgba(255,255,255,0.3); border: none; border-radius: 4px; cursor: pointer; color: inherit; font-weight: 600;">‚úï</button>
            `;
        } else {
            // Auto-hide after 6 seconds
            alert.textContent = message;
            setTimeout(() => {
                alert.classList.remove('show');
            }, 6000);
        }
    }
};

window.QuoteUI = QuoteUI;

// Initialize on load - with authentication check
document.addEventListener('DOMContentLoaded', async () => {
    try {
        // Check authentication and role
        const result = await requireRole(['customer']);
        if (!result) return; // redirected to login
        
        const { user, profile } = result;
        
        // Display user name
        const nameDisplay = document.getElementById('userName');
        if (nameDisplay && profile) {
            const displayName = profile.name && profile.name.trim() !== '' ? profile.name : profile.email;
            nameDisplay.textContent = displayName;
        }
        
        // Store user info for later use
        window.currentUser = user;
        window.currentProfile = profile;
        
        // Initialize UI
        QuoteUI.init();
        
    } catch (error) {
        console.error('Initialization error:', error);
        alert('Error loading page. Please refresh or contact support.');
    }
});

// ============================================
// QUOTE STORAGE - localStorage management
// ============================================
const QuoteStorage = {
    STORAGE_KEY: 'paskal_quotes',
    
    generateQuoteId(prefix = 'Q') {
        const quotes = this.getAllQuotes();
        
        // Filter by prefix to get correct numbering
        const prefixQuotes = quotes.filter(q => String(q.id || '').startsWith(prefix + '-'));
        const maxId = prefixQuotes.length > 0 
            ? Math.max(...prefixQuotes.map(q => parseInt(String(q.id || '').replace(prefix + '-', '')))) 
            : 0;
        return `${prefix}-${String(maxId + 1).padStart(4, '0')}`;
    },
    
    getAllQuotes() {
        const stored = localStorage.getItem(this.STORAGE_KEY);
        return stored ? JSON.parse(stored) : [];
    },
    
    saveQuote(quoteData) {
        const quotes = this.getAllQuotes();
        quotes.push(quoteData);
        localStorage.setItem(this.STORAGE_KEY, JSON.stringify(quotes));
    },
    
    getQuote(quoteId) {
        const quotes = this.getAllQuotes();
        return quotes.find(q => q.id === quoteId);
    },
    
    updateQuote(quoteId, updatedData) {
        const quotes = this.getAllQuotes();
        const index = quotes.findIndex(q => q.id === quoteId);
        if (index !== -1) {
            quotes[index] = updatedData;
            localStorage.setItem(this.STORAGE_KEY, JSON.stringify(quotes));
        }
    },
    
    deleteQuote(quoteId) {
        const quotes = this.getAllQuotes();
        const filtered = quotes.filter(q => q.id !== quoteId);
        localStorage.setItem(this.STORAGE_KEY, JSON.stringify(filtered));
    }
};

// ============================================
// EXCEL GENERATOR - Creates Excel file
// ============================================
const ExcelGenerator = {
    // Embedded Excel Template (base64) - MetalHook Template without images
    templateBase64: `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`,
    
    generatePN(item) {
        // Generate PN according to Paskal syntax
        // 5{hook_size}{hook_type}-{twine_on_hook}+{free_fall}{color_info}-{twine_type}
        
        let pn = '5';
        
        // Hook size (18 or 22) - convert 180‚Üí18, 220‚Üí22
        let hookSize = String(item.hookSize);
        if (hookSize === '180') {
            pn += '18';
        } else if (hookSize === '220') {
            pn += '22';
        } else {
            pn += hookSize; // fallback
        }
        
        // Hook type
        const hookTypeMap = {
            'Turbo': 'pk',
            'Tail': 'tl',
            'No free fall': 'nf'
        };
        pn += hookTypeMap[item.hookType] || 'pk';
        
        // NO dash here! Format: 518pk16+3w-12 (not 518pk-16+3w-12)
        
        // Twine on hook (remove .0 if whole number)
        let twineOnHook = String(item.wireLength || '');
        if (twineOnHook && twineOnHook.includes('.') && parseFloat(twineOnHook) === parseInt(twineOnHook)) {
            twineOnHook = String(parseInt(twineOnHook));
        }
        pn += twineOnHook;
        
        // Plus
        pn += '+';
        
        // Free fall (remove .0 if whole number)
        let freeFall = String(item.freeFallLength || '');
        if (freeFall && freeFall.includes('.') && parseFloat(freeFall) === parseInt(freeFall)) {
            freeFall = String(parseInt(freeFall));
        }
        pn += freeFall;
        
        // Color info (NO DASH before color!)
        const colorMap = {
            'White': 'w', 'Black': 'b', 'Blue': 'l',
            'Orange': 'o', 'Yellow': 'y', 'Green': 'g', 'Red': 'r'
        };
        
        if (item.colorMode === 'sequence' && item.colors && item.colors.length > 0) {
            // Mixed colors: w10o5b3
            for (const colorItem of item.colors) {
                const abbr = colorMap[colorItem.color] || 'w';
                pn += abbr + colorItem.quantity;
            }
        } else if (item.colors && item.colors.length > 0) {
            // Single color: w, b, l, etc.
            const abbr = colorMap[item.colors[0].color] || 'w';
            pn += abbr;
        } else {
            pn += 'w'; // Default white
        }
        
        // Dash
        pn += '-';
        
        // Twine type - convert 1000‚Üí10, 1200‚Üí12, 1300‚Üí13, 1500‚Üí15
        let twineType = String(item.twineType);
        if (twineType === '1000') {
            pn += '10';
        } else if (twineType === '1200') {
            pn += '12';
        } else if (twineType === '1300') {
            pn += '13';
        } else if (twineType === '1500') {
            pn += '15';
        } else {
            pn += twineType; // Bio250, Bio390, etc.
        }
        
        return pn;
    },
    
    formatMixedColors(colors) {
        // Format for column J: w10-o5-b3
        if (!colors || colors.length === 0) return "";
        
        const colorMap = {
            'White': 'w', 'Black': 'b', 'Blue': 'l',
            'Orange': 'o', 'Yellow': 'y', 'Green': 'g', 'Red': 'r'
        };
        
        const parts = [];
        for (const colorItem of colors) {
            const abbr = colorMap[colorItem.color] || 'w';
            parts.push(abbr + colorItem.quantity);
        }
        
        return parts.join('-');
    },
    
    async generateExcel(quoteData) {
        try {
            // Decode base64 template
            const binaryString = atob(this.templateBase64);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            
            // Load workbook with ExcelJS
            const workbook = new ExcelJS.Workbook();
            await workbook.xlsx.load(bytes.buffer);
            
            const worksheet = workbook.getWorksheet(1) || workbook.worksheets[0];
            
            // Clear Production Site (B8) - should be empty by default
            worksheet.getCell('B8').value = '';
            
            // Fill data starting from row 24
            const START_ROW = 24;
            
            for (let idx = 0; idx < quoteData.items.length; idx++) {
                const item = quoteData.items[idx];
                const rowNum = START_ROW + idx;
                
                // Generate PN
                const pn = this.generatePN(item);
                
                // Fill columns
                worksheet.getCell(`C${rowNum}`).value = item.grower || '';
                worksheet.getCell(`D${rowNum}`).value = item.shipTo || '';
                worksheet.getCell(`E${rowNum}`).value = item.hookType || '';
                const displaySize = item.hookSize === '180' ? '18' : item.hookSize === '220' ? '22' : item.hookSize || '';
                worksheet.getCell(`F${rowNum}`).value = displaySize;
                worksheet.getCell(`G${rowNum}`).value = item.crop || '';
                worksheet.getCell(`H${rowNum}`).value = CONFIG.TWINE_DISPLAY_NAMES[item.twineType] || item.twineType || '';
                
                // Color handling
                if (item.colorMode === 'sequence' && item.colors && item.colors.length > 0) {
                    // Mixed colors
                    worksheet.getCell(`I${rowNum}`).value = ""; // Column I empty
                    worksheet.getCell(`J${rowNum}`).value = this.formatMixedColors(item.colors); // Column J with abbreviated format
                } else if (item.colors && item.colors.length > 0) {
                    // Single color
                    worksheet.getCell(`I${rowNum}`).value = item.colors[0].color || ''; // Full name
                    worksheet.getCell(`J${rowNum}`).value = ""; // Column J empty
                } else {
                    worksheet.getCell(`I${rowNum}`).value = "";
                    worksheet.getCell(`J${rowNum}`).value = "";
                }
                
                worksheet.getCell(`K${rowNum}`).value = item.wireLength || '';
                worksheet.getCell(`L${rowNum}`).value = item.freeFallLength || '';
                worksheet.getCell(`M${rowNum}`).value = item.totalLength || '';
                worksheet.getCell(`N${rowNum}`).value = item.units || '';
                worksheet.getCell(`O${rowNum}`).value = new Date().toISOString().split('T')[0];
                worksheet.getCell(`P${rowNum}`).value = item.reqDate || '';
                worksheet.getCell(`X${rowNum}`).value = pn; // Generated PN
                worksheet.getCell(`Z${rowNum}`).value = item.unitsPerBox || '';
                worksheet.getCell(`AA${rowNum}`).value = item.boxes || '';
                worksheet.getCell(`AB${rowNum}`).value = item.boxes || ''; // Same as AA
                worksheet.getCell(`AC${rowNum}`).value = item.units || ''; // Same as N
            }
            
            // Generate Excel file
            const buffer = await workbook.xlsx.writeBuffer();
            return new Blob([buffer], { 
                type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' 
            });
            
        } catch (error) {
            console.error('Excel generation error:', error);
            throw new Error('Failed to generate Excel file: ' + error.message);
        }
    }
};

// ============================================
// ORDERS MANAGER - My Orders functionality
// ============================================
const TabManager = {
    switchTab(tabName) {
        // Check if currently in edit mode
        if (QuoteUI.editingQuoteId && tabName !== 'create') {
            if (!confirm(`You are currently editing ${QuoteUI.editingQuoteId}. Discard changes and switch tabs?`)) {
                return; // Don't switch tab - user wants to stay in edit mode
            }
            // User confirmed - clear edit mode WITHOUT another confirmation
            QuoteUI.clearEditMode();
        }
        
        // Check for unsaved data (not in edit mode)
        if (!QuoteUI.editingQuoteId && tabName !== 'create' && QuoteUI.hasUnsavedData()) {
            // Custom modal for save draft
            const modal = document.getElementById('validationModal');
            const body = document.getElementById('validationModalBody');
            
            body.innerHTML = `
                <h3 style="color: var(--paskal-navy); margin-bottom: 15px;">üíæ Save as Draft?</h3>
                <p style="color: #666; margin-bottom: 20px;">You have unsaved work. Would you like to save it as a draft before leaving?</p>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button class="btn btn-primary" onclick="
                        document.getElementById('validationModal').classList.remove('show');
                        QuoteUI.saveDraft();
                        setTimeout(() => TabManager.switchTab('${tabName}'), 500);
                    " style="flex: 1;">
                        üíæ Save Draft
                    </button>
                    <button class="btn btn-secondary" onclick="
                        document.getElementById('validationModal').classList.remove('show');
                        QuoteData.items = [];
                        QuoteData.nextId = 1;
                        const sr = document.getElementById('specialRequests');
                        if (sr) sr.value = '';
                        const cc = document.getElementById('charCount');
                        if (cc) cc.textContent = '0';
                        TabManager.switchTab('${tabName}');
                    " style="flex: 1;">
                        üóëÔ∏è Discard
                    </button>
                </div>
            `;
            
            modal.classList.add('show');
            return; // Stop here, let user decide
        }
        
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Deactivate all tab buttons
        document.querySelectorAll('.tab').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // Show selected tab
        if (tabName === 'create') {
            document.getElementById('createTab').classList.add('active');
            document.querySelectorAll('.tab')[0].classList.add('active');
            
            // DON'T clear form - keep user's work!
            // Only render to show current state
            if (QuoteData.items.length === 0) {
                // Only add empty item if array is completely empty
                QuoteData.nextId = 1;
                QuoteData.addItem();
            }
            QuoteUI.render();
            QuoteUI.updateSummary(); // Update summary to match current items
        } else if (tabName === 'orders') {
            document.getElementById('ordersTab').classList.add('active');
            document.querySelectorAll('.tab')[1].classList.add('active');
            OrdersManager.loadOrders();
        }
    },
    
    viewMyOrders() {
        // Close modal
        document.getElementById('successModal').classList.remove('show');
        
        // Clear any alerts
        const alertBox = document.getElementById('alertBox');
        if (alertBox) {
            alertBox.classList.remove('show');
        }
        
        // Switch to orders tab
        this.switchTab('orders');
        // Clear form
        QuoteData.items = [];
        QuoteData.nextId = 1;
        QuoteData.addItem();
        QuoteUI.editingQuoteId = null;
        
        // Reset buttons
        const generateBtn = document.getElementById('generateQuoteBtn');
        if (generateBtn) {
            generateBtn.innerHTML = 'üìã Generate Quote';
        }
        const cancelBtn = document.getElementById('cancelEditBtn');
        if (cancelBtn) {
            cancelBtn.style.display = 'none';
        }
        
        QuoteUI.render();
        QuoteUI.updateSummary(); // Update summary to show 0s
    }
};

window.TabManager = TabManager;

const OrdersManager = {
    getQuoteAge(quote) {
        // Calculate age in days
        const created = new Date(quote.dateCreated);
        const now = new Date();
        const diffMs = now - created;
        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        return diffDays;
    },
    
    async loadOrders() {
        try {
            const container = document.getElementById('ordersTableContainer');
            
            // Show loading state
            container.innerHTML = `
                <div class="empty-state">
                    <h3>‚è≥ Loading your orders...</h3>
                </div>
            `;
            
            // Get current user
            if (!window.currentUser) {
                console.error('No current user');
                return;
            }
            
            // Load quotes from Supabase for this customer only
            const { data: quotes, error } = await window.supabase
                .from('quotes')
                .select('*')
                .eq('customer_id', window.currentUser.id)
                .order('created_at', { ascending: false });
            
            if (error) {
                console.error('Error loading quotes:', error);
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>‚ùå Error Loading Orders</h3>
                        <p>${error.message}</p>
                        <button class="btn btn-primary" onclick="OrdersManager.loadOrders()" style="margin-top: 20px;">
                            üîÑ Retry
                        </button>
                    </div>
                `;
                return;
            }
            
            if (!quotes || quotes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>üì≠ No Orders Yet</h3>
                        <p>Create your first quote to see it here!</p>
                        <button class="btn btn-primary" onclick="TabManager.switchTab('create')" style="margin-top: 20px;">
                            üìù Create Quote
                        </button>
                    </div>
                `;
                return;
            }
            
            // Map Supabase quotes to local format
            const mappedQuotes = quotes.map(dbQuote => ({
                id: dbQuote.id,
                dateCreated: dbQuote.created_at || dbQuote.updated_at,
                status: dbQuote.status || 'Pending',
                summary: {
                    totalItems: dbQuote.total_items || 0,
                    totalUnits: dbQuote.total_units || 0,
                    totalBoxes: dbQuote.total_boxes || 0
                },
                items: dbQuote.items || []
            }));
            
            let html = `
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>Quote ID</th>
                            <th>Date</th>
                            <th>Items</th>
                            <th>Units</th>
                            <th>Boxes</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            mappedQuotes.forEach(quote => {
                const statusClass = `status-${(quote.status || 'pending').toLowerCase()}`;
                const quoteAge = this.getQuoteAge(quote);
                
                // Edit restrictions: only within 14 days
                const withinEditWindow = quoteAge <= 14;
                const canEdit = withinEditWindow && (quote.status === 'Pending' || quote.status === 'Rejected' || quote.status === 'Draft');
                
                // Duplicate: always available for Pending/Approved, OR if quote is older than 14 days
                const canDuplicate = quote.status === 'Pending' || quote.status === 'Approved' || !withinEditWindow;
                
                const canDelete = quote.status === 'Pending' || quote.status === 'Rejected' || quote.status === 'Draft';
                
                // Age indicator for tooltips
                const ageText = quoteAge === 0 ? 'Today' : quoteAge === 1 ? '1 day old' : `${quoteAge} days old`;
                const editTooltip = withinEditWindow ? 'Edit' : `Edit disabled (${ageText}, >14 days)`;
                const duplicateTooltip = !withinEditWindow ? `Duplicate (Edit locked after 14 days)` : 'Duplicate';
                
                html += `
                    <tr>
                        <td><strong>${quote.id}</strong></td>
                        <td>${new Date(quote.dateCreated).toLocaleDateString()}</td>
                        <td>${quote.summary?.totalItems || 0}</td>
                        <td>${quote.summary?.totalUnits?.toLocaleString() || 0}</td>
                        <td>${quote.summary?.totalBoxes || 0}</td>
                        <td><span class="status-badge ${statusClass}">${quote.status || 'Pending'}</span></td>
                        <td style="white-space: nowrap; min-width: 400px;">
                            <button class="action-btn" onclick="OrdersManager.viewDetails('${quote.id}')" title="View Details">
                                üëÅ
                            </button>
                            <button class="action-btn" onclick="(async () => await OrdersManager.downloadQuote('${quote.id}'))()" title="Download Excel">
                                üì•
                            </button>
                            <button class="action-btn" ${canEdit ? '' : 'disabled'} onclick="OrdersManager.editQuote('${quote.id}')" title="${editTooltip}">
                                ‚úèÔ∏è
                            </button>
                            <button class="action-btn" ${canDuplicate ? '' : 'disabled'} onclick="OrdersManager.duplicateQuote('${quote.id}')" title="${duplicateTooltip}">
                                üìã
                            </button>
                            <button class="action-btn" ${canDelete ? '' : 'disabled'} onclick="OrdersManager.deleteQuote('${quote.id}')" title="Delete">
                                üóë
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
            
        } catch (error) {
            console.error('Error in loadOrders:', error);
            const container = document.getElementById('ordersTableContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <h3>‚ùå Error Loading Orders</h3>
                    <p>Please refresh the page or contact support</p>
                </div>
            `;
        }
    },
                        </button>
                        <button class="action-btn" onclick="(async () => await OrdersManager.downloadQuote('${quote.id}'))()" title="Download Excel">
                            üì•
                        </button>
                        <button class="action-btn" ${canEdit ? '' : 'disabled'} onclick="OrdersManager.editQuote('${quote.id}')" title="${editTooltip}">
                            ‚úèÔ∏è
                        </button>
                        <button class="action-btn" ${canDuplicate ? '' : 'disabled'} onclick="OrdersManager.duplicateQuote('${quote.id}')" title="${duplicateTooltip}">
                            üìã
                        </button>
                        <button class="action-btn" ${canDelete ? '' : 'disabled'} onclick="OrdersManager.deleteQuote('${quote.id}')" title="Delete">
                            üóë
                        </button>
                    </td>
                </tr>
            `;
        });
        
        html += `
                </tbody>
            </table>
        `;
        
        container.innerHTML = html;
    },
    
    refreshOrders() {
        this.loadOrders();
        QuoteUI.showAlert('Orders refreshed!', 'success');
    },
    
    viewDetails(quoteId) {
        const quote = QuoteStorage.getQuote(quoteId);
        if (!quote) return;
        
        const modal = document.getElementById('viewDetailsModal');
        const body = document.getElementById('viewDetailsBody');
        
        let itemsHtml = `
            <table class="orders-table" style="margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Final Customer</th>
                        <th>Ship To</th>
                        <th>Hook Type</th>
                        <th>Size</th>
                        <th>Twine</th>
                        <th>Total Twine (m)</th>
                        <th>PN (product number)</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        quote.items.forEach((item, idx) => {
            itemsHtml += `
                <tr>
                    <td>${idx + 1}</td>
                    <td>${item.grower || '-'}</td>
                    <td>${item.shipTo || '-'}</td>
                    <td>${item.hookType || '-'}</td>
                    <td>${item.hookSize === '180' ? '18' : item.hookSize === '220' ? '22' : item.hookSize || '-'}</td>
                    <td>${CONFIG.TWINE_DISPLAY_NAMES[item.twineType] || item.twineType || '-'}</td>
                    <td>${item.totalLength ? item.totalLength.toFixed(1) : '-'}</td>
                    <td><code>${item.pn || '-'}</code></td>
                </tr>
            `;
        });
        
        itemsHtml += '</tbody></table>';
        
        body.innerHTML = `
            <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p><strong>Quote ID:</strong> ${quote.id}</p>
                <p><strong>Date Created:</strong> ${new Date(quote.dateCreated).toLocaleDateString()}</p>
                <p><strong>Status:</strong> <span class="status-badge status-${(quote.status || 'pending').toLowerCase()}">${quote.status || 'Pending'}</span></p>
            </div>
            
            ${itemsHtml}
            
            <div style="background: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px; color: var(--paskal-navy);">üìä Summary</h3>
                <p><strong>Total Items:</strong> ${quote.summary.totalItems}</p>
                <p><strong>Total Units:</strong> ${quote.summary.totalUnits.toLocaleString()}</p>
                <p><strong>Total Boxes:</strong> ${quote.summary.totalBoxes}</p>
            </div>
            
            ${quote.specialRequests ? `
                <div style="background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 2px solid var(--paskal-teal);">
                    <h3 style="margin-bottom: 15px; color: var(--paskal-navy);">üí¨ Customer Special Requests</h3>
                    <p style="white-space: pre-wrap; line-height: 1.6; color: #333;">${quote.specialRequests}</p>
                </div>
            ` : ''}
            
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="(async () => await OrdersManager.downloadQuote('${quote.id}'))()" style="flex: 1;">
                        üì• Download Excel
                    </button>
                    <button class="btn btn-primary" onclick="(async () => await OrdersManager.downloadQuotePDF('${quote.id}'))()" style="flex: 1;">
                        üìÑ Download PDF
                    </button>
                </div>
                <button class="btn btn-secondary" onclick="document.getElementById('viewDetailsModal').classList.remove('show')">
                    Close
                </button>
            </div>
        `;
        
        modal.classList.add('show');
    },
    
    async downloadQuote(quoteId) {
        const quote = QuoteStorage.getQuote(quoteId);
        if (!quote) return;
        
        QuoteUI.currentQuote = quote;
        await QuoteUI.downloadExcelFile();
    },
    
    async downloadQuotePDF(quoteId) {
        const quote = QuoteStorage.getQuote(quoteId);
        if (!quote) return;
        
        QuoteUI.currentQuote = quote;
        await QuoteUI.downloadPDFFile();
    },
    
    duplicateQuote(quoteId) {
        const quote = QuoteStorage.getQuote(quoteId);
        if (!quote) return;
        
        if (!confirm(`Duplicate quote ${quoteId}?`)) return;
        
        // Create new quote with same data
        const newQuote = {
            ...quote,
            id: QuoteStorage.generateQuoteId(),
            dateCreated: new Date().toISOString(),
            status: 'Pending'
        };
        
        QuoteStorage.saveQuote(newQuote);
        this.loadOrders();
        QuoteUI.showAlert(`Quote duplicated as ${newQuote.id}`, 'success');
    },
    
    deleteQuote(quoteId) {
        if (!confirm(`Delete quote ${quoteId}? This cannot be undone.`)) return;
        
        QuoteStorage.deleteQuote(quoteId);
        this.loadOrders();
        QuoteUI.showAlert('Quote deleted', 'success');
    },
    
    editQuote(quoteId) {
        const quote = QuoteStorage.getQuote(quoteId);
        if (!quote) return;
        
        if (!confirm(`Edit quote ${quoteId}?`)) return;
        
        // Close View Details Modal
        document.getElementById('viewDetailsModal').classList.remove('show');
        
        // Store original state for change tracking
        QuoteUI.originalQuoteState = JSON.parse(JSON.stringify(quote));
        
        // Load quote data into form
        QuoteData.items = quote.items.map(item => ({...item}));
        QuoteUI.editingQuoteId = quoteId;
        
        // Load special requests
        const specialRequestsField = document.getElementById('specialRequests');
        const charCount = document.getElementById('charCount');
        if (specialRequestsField) {
            specialRequestsField.value = quote.specialRequests || '';
            if (charCount) {
                charCount.textContent = (quote.specialRequests || '').length;
            }
        }
        
        // Update Generate button to Update Quote
        const generateBtn = document.getElementById('generateQuoteBtn');
        if (generateBtn) {
            generateBtn.innerHTML = 'üìù Update Quote';
        }
        
        // Show Cancel button
        const cancelBtn = document.getElementById('cancelEditBtn');
        if (cancelBtn) {
            cancelBtn.style.display = 'inline-block';
        }
        
        // Switch to Create tab
        TabManager.switchTab('create');
        
        // Render form with data
        QuoteUI.render();
        
        // Update summary immediately
        QuoteUI.updateSummary();
        
        // Scroll to top
        window.scrollTo(0, 0);
        
        QuoteUI.showAlert(`Editing ${quoteId} - Make changes and click "Update Quote" or "Cancel Edit"`, 'warning', false);
    }
};






    
    

</script>

<!-- ========================================
         VIEW DETAILS MODAL
         ======================================== -->
    <div class="modal" id="viewDetailsModal">
        <div class="modal-content" style="max-width: 900px; position: relative;">
            <button onclick="document.getElementById('viewDetailsModal').classList.remove('show')" 
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.8rem; color: #666; cursor: pointer; padding: 5px 10px; line-height: 1; transition: color 0.2s, transform 0.2s;"
                    onmouseover="this.style.color='#000'; this.style.transform='scale(1.1)';"
                    onmouseout="this.style.color='#666'; this.style.transform='scale(1)';"
                    title="Close">
                ‚úï
            </button>
            <h2 style="color: var(--paskal-navy); margin-bottom: 20px;">üìã Quote Details</h2>
            <div id="viewDetailsBody"></div>
        </div>
    </div>

<!-- ========================================
         SUCCESS MODAL - Quote Created
         ======================================== -->
    <div class="modal" id="successModal">
        <div class="modal-content" style="max-width: 600px;">
            <h2 style="color: var(--success-green); margin-bottom: 20px;">‚úÖ Quote Created Successfully!</h2>
            <div id="successModalBody"></div>
        </div>
    </div>

</body>
</html>
